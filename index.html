<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Обмен Феникса</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Подключение красивых шрифтов -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Exo+2:ital,wght@0,100..900;1,100..900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* Все предыдущие стили остаются без изменений */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    :root {
      --primary: #8a2be2;
      --primary-dark: #4d00ff;
      --primary-light: #9d4edd;
      --accent: #ff006e;
      --accent-glow: rgba(255, 0, 110, 0.7);
      --neon-blue: #00f5ff;
      --neon-purple: #bc00ff;
      --dark-bg: #0a0a1a;
      --darker-bg: #050510;
      --card-bg: rgba(20, 10, 40, 0.85);
      --card-border: rgba(138, 43, 226, 0.3);
      --text-primary: #ffffff;
      --text-secondary: #e0e0e0;
      --text-glow: rgba(255, 255, 255, 0.8);
    }
    
    /* Светлая тема */
    .light-theme {
      --primary: #8a2be2;
      --primary-dark: #4d00ff;
      --primary-light: #9d4edd;
      --accent: #ff006e;
      --accent-glow: rgba(255, 0, 110, 0.7);
      --neon-blue: #00a2ff;
      --neon-purple: #9c00ff;
      --dark-bg: #f5f5f7;
      --darker-bg: #e8e8ed;
      --card-bg: rgba(255, 255, 255, 0.95);
      --card-border: rgba(138, 43, 226, 0.2);
      --text-primary: #333333;
      --text-secondary: #666666;
      --text-glow: rgba(0, 0, 0, 0.8);
    }
    
    body {
      font-family: 'Exo 2', 'Rajdhani', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--text-primary);
      min-height: 100vh;
      background: 
        radial-gradient(circle at 20% 80%, rgba(77, 0, 255, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 0, 110, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
        linear-gradient(135deg, var(--darker-bg) 0%, var(--dark-bg) 50%, var(--darker-bg) 100%);
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow-x: hidden;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        linear-gradient(90deg, transparent 98%, rgba(138, 43, 226, 0.03) 100%),
        linear-gradient(0deg, transparent 98%, rgba(138, 43, 226, 0.03) 100%);
      background-size: 30px 30px;
      pointer-events: none;
      z-index: 1;
    }
    
    /* Киберпанк заставка */
    .cyberpunk-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a1a 0%, #050510 50%, #0a0a1a 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      overflow: hidden;
    }
    
    .cyberpunk-loader::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        linear-gradient(90deg, transparent 98%, rgba(138, 43, 226, 0.1) 100%),
        linear-gradient(0deg, transparent 98%, rgba(138, 43, 226, 0.1) 100%);
      background-size: 50px 50px;
      animation: gridMove 20s linear infinite;
    }
    
    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(50px, 50px); }
    }
    
    .cyber-logo {
      width: 200px;
      height: 200px;
      position: relative;
      margin-bottom: 40px;
      filter: drop-shadow(0 0 20px var(--primary)) 
              drop-shadow(0 0 40px var(--primary-light))
              drop-shadow(0 0 60px var(--accent));
      animation: logoPulse 3s ease-in-out infinite alternate;
    }
    
    @keyframes logoPulse {
      0% {
        transform: scale(1);
        filter: drop-shadow(0 0 20px var(--primary)) 
                drop-shadow(0 0 40px var(--primary-light))
                drop-shadow(0 0 60px var(--accent));
      }
      100% {
        transform: scale(1.05);
        filter: drop-shadow(0 0 25px var(--primary)) 
                drop-shadow(0 0 50px var(--primary-light))
                drop-shadow(0 0 75px var(--accent));
      }
    }
    
    .cyber-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 4rem;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--primary);
      margin-bottom: 20px;
      text-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
      letter-spacing: 2px;
    }
    
    .cyber-subtitle {
      font-family: 'Rajdhani', sans-serif;
      font-size: 1.2rem;
      color: var(--neon-blue);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 40px;
      text-shadow: 0 0 10px var(--neon-blue);
      animation: subtitlePulse 2s ease-in-out infinite alternate;
    }
    
    @keyframes subtitlePulse {
      0% { opacity: 0.7; }
      100% { opacity: 1; }
    }
    
    .loading-bar {
      width: 400px;
      height: 6px;
      background: rgba(138, 43, 226, 0.2);
      border-radius: 3px;
      overflow: hidden;
      position: relative;
      margin-bottom: 20px;
    }
    
    .loading-progress {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--primary) 0%, var(--neon-blue) 50%, var(--accent) 100%);
      border-radius: 3px;
      animation: loading 3s ease-in-out forwards;
      box-shadow: 0 0 10px var(--primary);
    }
    
    @keyframes loading {
      0% { width: 0%; }
      100% { width: 100%; }
    }
    
    .cyber-grid {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }
    
    .grid-line {
      position: absolute;
      background: rgba(138, 43, 226, 0.1);
    }
    
    .grid-line.vertical {
      width: 1px;
      height: 100%;
      top: 0;
    }
    
    .grid-line.horizontal {
      width: 100%;
      height: 1px;
      left: 0;
    }
    
    .cyber-particle {
      position: absolute;
      width: 3px;
      height: 3px;
      background: var(--neon-blue);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--neon-blue);
      animation: particleFloat 10s linear infinite;
    }
    
    @keyframes particleFloat {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) translateX(100px);
        opacity: 0;
      }
    }
    
    .hacking-text {
      font-family: 'Rajdhani', monospace;
      font-size: 1rem;
      color: var(--neon-blue);
      text-align: center;
      margin-top: 20px;
      height: 60px;
      overflow: hidden;
      width: 600px;
    }
    
    .hacking-line {
      animation: hackText 0.5s linear forwards;
      opacity: 0;
    }
    
    @keyframes hackText {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    /* Стили для частиц */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
    
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: var(--primary);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--primary), 0 0 20px var(--primary);
      animation: float 15s infinite linear;
    }
    
    @keyframes float {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) translateX(100px);
        opacity: 0;
      }
    }
    
    /* Центрированный шапка с логотипом и названием */
    header {
      background: rgba(10, 5, 25, 0.95);
      padding: 15px 30px;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: text;
      z-index: 10;
      position: relative;
      font-family: 'Orbitron', sans-serif;
      font-weight: 700;
      font-size: 2.8rem;
      color: var(--primary);
      text-shadow: 0 0 20px rgba(138, 43, 226, 0.7);
      border-bottom: 1px solid rgba(138, 43, 226, 0.3);
      backdrop-filter: blur(10px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme header {
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid rgba(138, 43, 226, 0.2);
    }
    
    .header-content {
      display: flex;
      align-items: center;
      gap: 15px;
      cursor: pointer;
      transition: all 0.4s ease;
      padding: 5px 15px;
      border-radius: 15px;
      background: rgba(138, 43, 226, 0.1);
      border: 1px solid rgba(138, 43, 226, 0.2);
    }
    
    .header-content:hover {
      transform: scale(1.03) translateY(-2px);
      background: rgba(138, 43, 226, 0.2);
      box-shadow: 0 5px 20px rgba(138, 43, 226, 0.4);
    }
    
    header img {
      width: 60px;
      height: 60px;
      object-fit: contain;
      filter: 
        drop-shadow(0 0 8px var(--primary)) 
        drop-shadow(0 0 15px var(--primary-light));
      animation: logoGlow 3s ease-in-out infinite alternate;
    }
    
    .light-theme header img {
      filter: none;
    }
    
    @keyframes logoGlow {
      0% {
        filter: 
          drop-shadow(0 0 8px var(--primary)) 
          drop-shadow(0 0 15px var(--primary-light));
      }
      100% {
        filter: 
          drop-shadow(0 0 12px var(--primary)) 
          drop-shadow(0 0 25px var(--primary-light));
      }
    }
    
    .user-section {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
      color: var(--text-primary);
      font-size: 1rem;
      padding: 8px 15px;
      border-radius: 50px;
      background: rgba(20, 10, 40, 0.7);
      border: 1px solid rgba(138, 43, 226, 0.3);
      transition: all 0.3s ease;
    }
    
    .light-theme .user-info {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(138, 43, 226, 0.2);
    }
    
    .user-info:hover {
      background: rgba(30, 15, 60, 0.8);
      box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
    }
    
    .light-theme .user-info:hover {
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 15px rgba(138, 43, 226, 0.2);
    }
    
    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: 2px solid var(--primary);
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(77, 0, 255, 0.5);
      filter: brightness(1.1);
      object-fit: cover;
    }
    
    .user-avatar:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(77, 0, 255, 0.8);
    }
    
    .fortune-icon {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: 2px solid #ffd700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      background: rgba(255, 215, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: #ffd700;
    }
    
    .fortune-icon:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
      background: rgba(255, 215, 0, 0.2);
    }
    
    .auth-buttons {
      display: flex;
      gap: 12px;
    }
    
    .auth-btn {
      padding: 10px 20px;
      background: linear-gradient(135deg, rgba(77, 0, 255, 0.2) 0%, rgba(138, 43, 226, 0.2) 100%);
      border: 1px solid var(--primary);
      border-radius: 25px;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      font-family: 'Exo 2', sans-serif;
      position: relative;
      overflow: hidden;
    }
    
    .light-theme .auth-btn {
      background: linear-gradient(135deg, rgba(77, 0, 255, 0.1) 0%, rgba(138, 43, 226, 0.1) 100%);
    }
    
    .auth-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    
    .auth-btn:hover {
      background: linear-gradient(135deg, rgba(77, 0, 255, 0.4) 0%, rgba(138, 43, 226, 0.4) 100%);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    .auth-btn:hover::before {
      left: 100%;
    }
    
    /* Кнопка переключения темы */
    .theme-toggle {
      background: rgba(138, 43, 226, 0.1);
      border: 1px solid rgba(138, 43, 226, 0.3);
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--text-primary);
      font-size: 1.2rem;
    }
    
    .light-theme .theme-toggle {
      background: rgba(138, 43, 226, 0.1);
      border: 1px solid rgba(138, 43, 226, 0.2);
    }
    
    .theme-toggle:hover {
      background: rgba(138, 43, 226, 0.2);
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
    }
    
    /* НОВЫЙ СТИЛЬ ДЛЯ КНОПКИ VK УПРАВЛЕНИЯ */
    .vk-management-btn {
      background: linear-gradient(135deg, #0077ff 0%, #00a2ff 50%, #00ddff 100%);
      border: 1px solid #00a2ff;
      color: var(--text-primary);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      font-family: 'Exo 2', sans-serif;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .vk-management-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    
    .vk-management-btn:hover {
      background: linear-gradient(135deg, #00a2ff 0%, #00ddff 100%);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 162, 255, 0.4);
    }
    
    .vk-management-btn:hover::before {
      left: 100%;
    }
    
    nav {
      background: rgba(15, 8, 35, 0.95);
      padding: 18px 0;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      gap: 35px;
      user-select: text;
      z-index: 10;
      position: relative;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(138, 43, 226, 0.2);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme nav {
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid rgba(138, 43, 226, 0.1);
    }
    
    nav a {
      color: var(--text-primary);
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      padding: 10px 22px;
      border-radius: 25px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      background: rgba(138, 43, 226, 0.1);
      border: 1px solid transparent;
    }
    
    .light-theme nav a {
      background: rgba(138, 43, 226, 0.05);
    }
    
    nav a::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
      opacity: 0;
      transition: opacity 0.3s;
      z-index: -1;
      border-radius: 25px;
    }
    
    nav a:hover {
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
      border: 1px solid rgba(138, 43, 226, 0.5);
    }
    
    nav a:hover::before {
      opacity: 1;
    }
    
    /* Модальные окна */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(5, 5, 15, 0.9);
      backdrop-filter: blur(8px);
      overflow: auto;
    }
    
    .light-theme .modal {
      background-color: rgba(0, 0, 0, 0.7);
    }
    
    .modal-content {
      background: linear-gradient(135deg, rgba(26, 15, 56, 0.95) 0%, rgba(15, 8, 35, 0.95) 100%);
      margin: 2% auto;
      padding: 25px;
      border-radius: 20px;
      width: 90%;
      max-width: 450px;
      max-height: 90vh;
      overflow-y: auto;
      border: 1px solid rgba(138, 43, 226, 0.4);
      box-shadow: 
        0 0 30px rgba(77, 0, 255, 0.5),
        inset 0 0 30px rgba(77, 0, 255, 0.1);
      position: relative;
      animation: modalAppear 0.4s ease-out;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .modal-content {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(240, 240, 255, 0.95) 100%);
      border: 1px solid rgba(138, 43, 226, 0.2);
      box-shadow: 
        0 0 30px rgba(77, 0, 255, 0.2),
        inset 0 0 30px rgba(77, 0, 255, 0.05);
    }
    
    .modal-content.large {
      max-width: 600px;
      max-height: 85vh;
    }
    
    .modal-content.extra-large {
      max-width: 800px;
      max-height: 80vh;
    }
    
    .modal-content::-webkit-scrollbar {
      width: 8px;
    }
    
    .modal-content::-webkit-scrollbar-track {
      background: rgba(138, 43, 226, 0.1);
      border-radius: 4px;
    }
    
    .modal-content::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 4px;
    }
    
    .modal-content::-webkit-scrollbar-thumb:hover {
      background: var(--primary-light);
    }
    
    @keyframes modalAppear {
      0% {
        opacity: 0;
        transform: scale(0.8) translateY(-20px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    
    .close {
      color: var(--primary);
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(138, 43, 226, 0.1);
      position: sticky;
      top: 10px;
      z-index: 10;
    }
    
    .close:hover {
      color: var(--accent);
      background: rgba(138, 43, 226, 0.2);
      transform: rotate(90deg);
    }
    
    .modal h2 {
      color: var(--primary);
      margin-bottom: 20px;
      text-align: center;
      font-family: 'Orbitron', sans-serif;
      font-weight: 600;
      font-size: 1.8rem;
      position: sticky;
      top: 0;
      background: rgba(26, 15, 56, 0.9);
      padding: 10px 0;
      margin-top: 0;
      z-index: 5;
    }
    
    .light-theme .modal h2 {
      background: rgba(255, 255, 255, 0.9);
    }
    
    .form-group {
      margin-bottom: 22px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-primary);
      font-weight: 600;
      font-size: 1rem;
    }
    
    .form-group input, .form-group select {
      width: 100%;
      padding: 14px;
      border: 1px solid rgba(138, 43, 226, 0.4);
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.08);
      color: var(--text-primary);
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .light-theme .form-group input, .light-theme .form-group select {
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(138, 43, 226, 0.3);
      color: #333;
    }
    
    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 15px rgba(77, 0, 255, 0.5);
      background: rgba(255, 255, 255, 0.12);
    }
    
    .light-theme .form-group input:focus, .light-theme .form-group select:focus {
      background: rgba(255, 255, 255, 1);
      box-shadow: 0 0 15px rgba(77, 0, 255, 0.2);
    }
    
    .submit-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 50%, var(--accent) 100%);
      border: none;
      border-radius: 10px;
      color: var(--text-primary);
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      font-family: 'Exo 2', sans-serif;
    }
    
    .submit-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: rgba(255, 255, 255, 0.1);
      transform: rotate(30deg);
      transition: all 0.5s;
      opacity: 0;
    }
    
    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(77, 0, 255, 0.5);
    }
    
    .submit-btn:hover::after {
      opacity: 1;
      transform: rotate(30deg) translate(10%, 10%);
    }
    
    .switch-form {
      text-align: center;
      margin-top: 22px;
      color: var(--text-secondary);
    }
    
    .switch-form a {
      color: var(--primary);
      cursor: pointer;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s;
    }
    
    .switch-form a:hover {
      color: var(--neon-blue);
      text-decoration: underline;
    }
    
    .admin-badge {
      background: linear-gradient(135deg, var(--accent) 0%, #ff3366 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      margin-left: 8px;
      box-shadow: 0 0 10px var(--accent-glow);
      font-weight: 600;
    }
    
    /* Баннер для неавторизованных пользователей */
    .banner-section {
      position: relative;
      overflow: hidden;
      height: 250px;
      background: rgba(10, 5, 25, 0.9);
      border-top: 1px solid rgba(138, 43, 226, 0.3);
      border-bottom: 1px solid rgba(138, 43, 226, 0.3);
      box-shadow: 
        0 5px 20px rgba(0, 0, 0, 0.5),
        inset 0 0 30px rgba(77, 0, 255, 0.1);
      user-select: none;
      z-index: 5;
      backdrop-filter: blur(5px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .banner-section {
      background: rgba(255, 255, 255, 0.9);
      border-top: 1px solid rgba(138, 43, 226, 0.2);
      border-bottom: 1px solid rgba(138, 43, 226, 0.2);
      box-shadow: 
        0 5px 20px rgba(0, 0, 0, 0.1),
        inset 0 0 30px rgba(77, 0, 255, 0.05);
    }
    
    .banner-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    .banner-slide {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .banner-slide.active {
      opacity: 1;
    }
    
    .banner-content {
      position: absolute;
      bottom: 20px;
      left: 20px;
      z-index: 2;
      text-align: left;
      background: rgba(10, 5, 25, 0.7);
      padding: 15px 25px;
      border-radius: 12px;
      border: 1px solid rgba(138, 43, 226, 0.5);
      box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
      backdrop-filter: blur(5px);
      max-width: 400px;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .banner-content {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(138, 43, 226, 0.3);
      box-shadow: 0 0 15px rgba(138, 43, 226, 0.1);
    }
    
    .banner-content h3 {
      color: var(--primary);
      font-size: 1.5rem;
      margin-bottom: 8px;
      font-family: 'Orbitron', sans-serif;
    }
    
    .banner-content p {
      color: var(--text-primary);
      font-size: 1rem;
      margin-bottom: 12px;
    }
    
    .banner-btn {
      display: inline-block;
      padding: 8px 20px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      text-decoration: none;
      border-radius: 20px;
      font-weight: 600;
      transition: all 0.3s ease;
      border: 1px solid rgba(138, 43, 226, 0.5);
      font-size: 0.9rem;
    }
    
    .banner-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    .banner-controls {
      position: absolute;
      bottom: 15px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 10px;
      z-index: 10;
    }
    
    .banner-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(138, 43, 226, 0.5);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .banner-dot.active {
      background: var(--primary);
      box-shadow: 0 0 8px var(--primary);
    }
    
    .banner-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(138, 43, 226, 0.3);
      color: white;
      border: none;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1rem;
      transition: all 0.3s ease;
      z-index: 10;
    }
    
    .banner-arrow:hover {
      background: rgba(138, 43, 226, 0.6);
      box-shadow: 0 0 12px rgba(138, 43, 226, 0.5);
    }
    
    .banner-arrow.prev {
      left: 15px;
    }
    
    .banner-arrow.next {
      right: 15px;
    }
    
    /* Секция с колесом фортуны */
    .fortune-section {
      background: var(--card-bg);
      border-radius: 20px;
      padding: 30px;
      margin: 30px auto;
      max-width: 1200px;
      border: 1px solid var(--card-border);
      box-shadow: 0 10px 30px rgba(77, 0, 255, 0.3);
      backdrop-filter: blur(10px);
      display: none;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .fortune-section h2 {
      color: var(--primary);
      text-align: center;
      margin-bottom: 25px;
      font-family: 'Orbitron', sans-serif;
      font-size: 2.2rem;
    }
    
    .fortune-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    
    .wheel-container {
      position: relative;
      width: 300px;
      height: 300px;
    }
    
    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      position: relative;
      transition: transform 5s cubic-bezier(0.17, 0.67, 0.83, 0.67);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
      border: 8px solid #ffd700;
      overflow: hidden;
    }
    
    .wheel-spinning {
      animation: wheelSpin 0.5s linear infinite;
    }
    
    @keyframes wheelSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .wheel-item {
      position: absolute;
      width: 50%;
      height: 50%;
      transform-origin: bottom right;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: white;
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
      font-size: 12px;
    }
    
    .wheel-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 60px;
      height: 60px;
      background: #ffd700;
      border-radius: 50%;
      border: 5px solid #fff;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: #000;
      font-weight: 600;
    }
    
    .wheel-pointer {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 60px;
      background: #ff6b6b;
      clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
      z-index: 20;
      box-shadow: 0 0 10px rgba(255, 107, 107, 0.7);
    }
    
    .spin-button {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border: none;
      color: white;
      padding: 15px 40px;
      border-radius: 25px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.2rem;
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    .spin-button:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(77, 0, 255, 0.6);
    }
    
    .spin-button:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .fortune-result {
      text-align: center;
      padding: 20px;
      background: rgba(77, 0, 255, 0.1);
      border-radius: 15px;
      border: 1px solid var(--primary);
      max-width: 500px;
      margin-top: 20px;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .fortune-result {
      background: rgba(77, 0, 255, 0.05);
    }
    
    .fortune-result h3 {
      color: var(--primary);
      margin-bottom: 15px;
    }
    
    .fortune-timer {
      text-align: center;
      color: var(--text-secondary);
      margin-top: 10px;
    }
    
    /* Модальное окно колеса фортуны */
    .fortune-modal .modal-content {
      max-width: 500px;
      padding: 25px;
    }
    
    /* Плавная бесконечная прокрутка снизу от навигации */
    .scrolling-list-wrapper {
      position: relative;
      overflow: hidden;
      height: 130px;
      background: rgba(10, 5, 25, 0.9);
      border-top: 1px solid rgba(138, 43, 226, 0.3);
      border-bottom: 1px solid rgba(138, 43, 226, 0.3);
      box-shadow: 
        0 5px 20px rgba(0, 0, 0, 0.5),
        inset 0 0 30px rgba(77, 0, 255, 0.1);
      user-select: none;
      z-index: 5;
      backdrop-filter: blur(5px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .scrolling-list-wrapper {
      background: rgba(255, 255, 255, 0.9);
      border-top: 1px solid rgba(138, 43, 226, 0.2);
      border-bottom: 1px solid rgba(138, 43, 226, 0.2);
      box-shadow: 
        0 5px 20px rgba(0, 0, 0, 0.1),
        inset 0 0 30px rgba(77, 0, 255, 0.05);
    }
    
    .scrolling-list {
      display: flex;
      gap: 40px;
      padding: 25px;
      will-change: transform;
    }
    
    .scrolling-item {
      flex: 0 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      color: var(--text-primary);
      font-weight: 600;
      font-size: 1rem;
      padding: 10px;
      border-radius: 12px;
      background: rgba(138, 43, 226, 0.1);
      border: 1px solid rgba(138, 43, 226, 0.2);
      transition: all 0.3s ease;
      min-width: 120px;
    }
    
    .light-theme .scrolling-item {
      background: rgba(138, 43, 226, 0.05);
      border: 1px solid rgba(138, 43, 226, 0.1);
    }
    
    .scrolling-item:hover {
      background: rgba(138, 43, 226, 0.2);
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.3);
    }
    
    .light-theme .scrolling-item:hover {
      background: rgba(138, 43, 226, 0.1);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.1);
    }
    
    .scrolling-item .image-container {
      position: relative;
      width: 90px;
      height: 60px;
    }
    
    .scrolling-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 8px;
      border: 1px solid rgba(138, 43, 226, 0.4);
      filter: brightness(1.1);
      transition: all 0.3s ease;
    }
    
    .scrolling-item:hover img {
      filter: brightness(1.2) drop-shadow(0 0 5px var(--primary));
    }
    
    main {
      flex-grow: 1;
      display: flex;
      gap: 40px;
      padding: 40px;
      background: transparent;
      overflow-y: auto;
      position: relative;
      z-index: 2;
    }
    
    section {
      flex: 1 1 50%;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.5),
        inset 0 0 30px rgba(77, 0, 255, 0.1);
      padding: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      border: 1px solid var(--card-border);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
    
    .light-theme section {
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.1),
        inset 0 0 30px rgba(77, 0, 255, 0.05);
    }
    
    section:hover {
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.6),
        inset 0 0 40px rgba(77, 0, 255, 0.15);
      transform: translateY(-5px);
    }
    
    .light-theme section:hover {
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.15),
        inset 0 0 40px rgba(77, 0, 255, 0.08);
    }
    
    section h2 {
      color: var(--primary);
      margin-bottom: 30px;
      font-size: 2.2rem;
      font-family: 'Orbitron', sans-serif;
      font-weight: 600;
      text-align: center;
      user-select: text;
      text-shadow: 0 0 15px rgba(77, 0, 255, 0.5);
    }
    
    .items-list {
      width: 100%;
      max-height: 500px;
      overflow-y: auto;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      padding: 10px;
    }
    
    .item-select {
      background: linear-gradient(145deg, rgba(42, 26, 74, 0.8) 0%, rgba(31, 15, 63, 0.8) 100%);
      border-radius: 15px;
      width: 160px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
      position: relative;
      border: 1px solid rgba(138, 43, 226, 0.3);
      overflow: hidden;
    }
    
    .light-theme .item-select {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 240, 255, 0.9) 100%);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(138, 43, 226, 0.2);
    }
    
    .item-select::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(138, 43, 226, 0.1) 0%, transparent 50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .item-select:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 25px rgba(77, 0, 255, 0.4);
      border: 1px solid rgba(138, 43, 226, 0.5);
    }
    
    .light-theme .item-select:hover {
      box-shadow: 0 12px 25px rgba(77, 0, 255, 0.2);
    }
    
    .item-select:hover::before {
      opacity: 1;
    }
    
    .item-select.selected {
      border: 2px solid #ffd700;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
      transform: translateY(-5px);
    }
    
    .item-select.selected::after {
      content: '✓';
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ffd700;
      color: #000;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 16px;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }
    
    .item-image-container {
      position: relative;
      width: 100%;
      height: 110px;
      margin-bottom: 12px;
    }
    
    .item-select img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid rgba(138, 43, 226, 0.4);
      transition: all 0.3s ease;
    }
    
    .item-select:hover img {
      border-color: rgba(138, 43, 226, 0.7);
      filter: brightness(1.1) saturate(1.2);
    }
    
    .item-select h3 {
      color: var(--text-primary);
      font-size: 1.1rem;
      margin-bottom: 8px;
      user-select: text;
      font-weight: 600;
    }
    
    .item-price {
      color: #ffd700;
      font-weight: 600;
      font-size: 0.9rem;
      margin-top: 5px;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    
    select#offer, select#want {
      margin-top: 25px;
      width: 100%;
      padding: 14px 18px;
      border-radius: 10px;
      font-size: 1rem;
      border: 1px solid rgba(138, 43, 226, 0.4);
      background-color: rgba(26, 15, 56, 0.8);
      color: var(--text-primary);
      user-select: auto;
      transition: all 0.3s ease;
    }
    
    .light-theme select#offer, .light-theme select#want {
      background-color: rgba(255, 255, 255, 0.9);
      color: #333;
    }
    
    select#offer:focus, select#want:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 15px rgba(77, 0, 255, 0.4);
    }
    
    .preview-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 30px 0 10px;
      width: 100%;
      user-select: none;
      position: relative;
      z-index: 10;
    }
    
    .preview-box {
      flex: 1;
      background: rgba(26,15,56,0.9);
      border-radius: 18px;
      padding: 20px;
      box-shadow: 0 8px 25px rgba(77, 0, 255, 0.3);
      text-align: center;
      position: relative;
      border: 1px solid rgba(138, 43, 226, 0.3);
      transition: all 0.3s ease;
    }
    
    .light-theme .preview-box {
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 8px 25px rgba(77, 0, 255, 0.1);
    }
    
    .preview-box:hover {
      box-shadow: 0 10px 30px rgba(77, 0, 255, 0.4);
      transform: translateY(-5px);
    }
    
    .preview-image-container {
      position: relative;
      width: 100%;
      height: 200px;
      margin-bottom: 15px;
    }
    
    .preview-box img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 12px;
      border: 1px solid rgba(138, 43, 226, 0.4);
    }
    
    .preview-box p {
      color: var(--text-primary);
      font-size: 1.1rem;
      font-weight: 600;
      user-select: text;
    }
    
    .preview-price {
      color: #ffd700;
      font-weight: 600;
      font-size: 1rem;
      margin-top: 5px;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    
    .exchange-arrow {
      font-size: 3.5rem;
      color: var(--primary);
      animation: pulse 2s infinite;
      user-select: none;
      filter: drop-shadow(0 0 10px var(--primary));
    }
    
    @keyframes pulse {
      0% { 
        transform: scale(1); 
        filter: drop-shadow(0 0 10px var(--primary));
      }
      50% { 
        transform: scale(1.1); 
        filter: drop-shadow(0 0 15px var(--primary-light));
      }
      100% { 
        transform: scale(1); 
        filter: drop-shadow(0 0 10px var(--primary));
      }
    }
    
    #exchangeButton {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 50%, var(--accent) 100%);
      border: none;
      color: var(--text-primary);
      padding: 16px 32px;
      font-weight: 600;
      font-size: 1.3rem;
      cursor: pointer;
      border-radius: 12px;
      width: 100%;
      max-width: 320px;
      margin: 0 auto 30px;
      display: block;
      transition: all 0.3s ease;
      user-select: auto;
      z-index: 10;
      position: relative;
      overflow: hidden;
      font-family: 'Exo 2', sans-serif;
      box-shadow: 0 8px 20px rgba(77, 0, 255, 0.4);
    }
    
    #exchangeButton::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    
    #exchangeButton:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 25px rgba(77, 0, 255, 0.5);
    }
    
    #exchangeButton:hover::before {
      left: 100%;
    }
    
    #exchangeButton:active {
      transform: translateY(-2px);
    }
    
    #exchangeButton:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    #exchangeButton:disabled:hover {
      background: #666;
      transform: none;
      box-shadow: none;
    }
    
    #exchangeButton:disabled::before {
      display: none;
    }
    
    footer {
      background: rgba(10, 5, 25, 0.95);
      padding: 30px 0;
      text-align: center;
      font-size: 1rem;
      color: var(--text-secondary);
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.5);
      user-select: text;
      z-index: 10;
      position: relative;
      border-top: 1px solid rgba(138, 43, 226, 0.2);
      backdrop-filter: blur(10px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme footer {
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
      border-top: 1px solid rgba(138, 43, 226, 0.1);
    }
    
    footer .social-icons {
      margin-top: 15px;
      display: flex;
      justify-content: center;
      gap: 25px;
    }
    
    footer .social-icons a {
      color: var(--primary);
      font-size: 1.8rem;
      transition: all 0.3s ease;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(138, 43, 226, 0.1);
      border: 1px solid rgba(138, 43, 226, 0.3);
    }
    
    .light-theme footer .social-icons a {
      background: rgba(138, 43, 226, 0.05);
      border: 1px solid rgba(138, 43, 226, 0.2);
    }
    
    footer .social-icons a:hover {
      transform: translateY(-5px);
      color: var(--neon-blue);
      background: rgba(138, 43, 226, 0.2);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    input, textarea, select, button {
      user-select: auto;
    }
    
    /* Стили для баланса */
    .balance-section {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(77, 0, 255, 0.2);
      padding: 8px 16px;
      border-radius: 20px;
      border: 1px solid var(--primary);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .light-theme .balance-section {
      background: rgba(77, 0, 255, 0.1);
    }
    
    .balance-section:hover {
      background: rgba(77, 0, 255, 0.3);
      transform: translateY(-2px);
      box-shadow: 0 0 10px rgba(77, 0, 255, 0.5);
    }
    
    .balance-amount {
      color: var(--primary);
      font-weight: 600;
      font-size: 1rem;
      text-shadow: 0 0 5px rgba(77, 0, 255, 0.7);
    }
    
    /* Стили для выбранных предметов */
    .selected-items-section {
      background: var(--card-bg);
      border-radius: 20px;
      padding: 30px;
      margin: 30px auto;
      max-width: 1200px;
      border: 1px solid var(--card-border);
      box-shadow: 0 10px 30px rgba(77, 0, 255, 0.3);
      backdrop-filter: blur(10px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .selected-items-section {
      box-shadow: 0 10px 30px rgba(77, 0, 255, 0.1);
    }
    
    .selected-items-grid {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 30px;
      align-items: start;
    }
    
    .selected-items-column {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .selected-items-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      min-height: 120px;
      padding: 20px;
      background: rgba(26, 15, 56, 0.7);
      border-radius: 15px;
      border: 2px dashed var(--primary);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .selected-items-list {
      background: rgba(255, 255, 255, 0.7);
    }
    
    .selected-item {
      background: linear-gradient(145deg, rgba(42, 26, 74, 0.9) 0%, rgba(31, 15, 63, 0.9) 100%);
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      width: 90px;
      position: relative;
      border: 1px solid var(--primary);
      transition: all 0.3s ease;
    }
    
    .light-theme .selected-item {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 240, 255, 0.9) 100%);
    }
    
    .selected-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.3);
    }
    
    .selected-item img {
      width: 100%;
      height: 60px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 5px;
    }
    
    .selected-item .item-name {
      color: var(--primary);
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .selected-item .item-price {
      color: #ffd700;
      font-size: 0.7rem;
    }
    
    .remove-item {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ff6b6b;
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .remove-item:hover {
      background: #ff5252;
      transform: scale(1.1);
    }
    
    .exchange-summary {
      text-align: center;
      padding: 20px;
      background: rgba(77, 0, 255, 0.1);
      border-radius: 15px;
      border: 1px solid var(--primary);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .exchange-summary {
      background: rgba(77, 0, 255, 0.05);
    }
    
    .summary-item {
      margin: 10px 0;
      color: var(--primary);
      font-size: 1.1rem;
    }
    
    .summary-total {
      color: #ffd700;
      font-size: 1.3rem;
      font-weight: 600;
      margin-top: 15px;
    }
    
    /* Стили для фильтров */
    .filters-section {
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(77, 0, 255, 0.3);
      padding: 30px;
      margin: 20px 0;
      width: 300px;
      border: 1px solid var(--card-border);
      backdrop-filter: blur(10px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .filters-section {
      box-shadow: 0 10px 30px rgba(77, 0, 255, 0.1);
    }
    
    .filters-grid {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .filter-label {
      color: var(--text-primary);
      font-weight: 600;
      font-size: 1rem;
    }
    
    .price-inputs {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .price-input-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .price-input-row input {
      flex: 1;
      padding: 10px;
      border: 1px solid var(--primary);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
    }
    
    .light-theme .price-input-row input {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }
    
    .price-separator {
      color: var(--text-primary);
      font-weight: 600;
      text-align: center;
      margin: 5px 0;
    }
    
    .filter-select {
      padding: 10px;
      border: 1px solid var(--primary);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-primary);
      font-weight: 600;
    }
    
    .light-theme .filter-select {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }
    
    .filter-select option {
      background: var(--card-bg);
      color: var(--text-primary);
      padding: 8px;
    }
    
    .save-filters-btn {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border: none;
      color: var(--text-primary);
      padding: 12px 20px;
      font-weight: 600;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .save-filters-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(77, 0, 255, 0.4);
    }
    
    /* УДАЛЕНЫ СТИЛИ ДЛЯ СЕКЦИИ САЙТОВЫХ ПОСТОВ НА СТРАНИЦЕ */
    /* Вместо этого добавляем стили для модального окна новостей сайта */
    
    .site-news-modal .modal-content {
      max-width: 900px;
      padding: 30px;
      background: linear-gradient(135deg, rgba(20, 10, 40, 0.95) 0%, rgba(10, 5, 25, 0.95) 100%);
    }
    
    .light-theme .site-news-modal .modal-content {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(240, 240, 255, 0.95) 100%);
    }
    
    .site-news-container {
      max-height: 70vh;
      overflow-y: auto;
      padding: 10px;
    }
    
    .site-news-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .site-news-header h2 {
      color: var(--primary);
      font-family: 'Orbitron', sans-serif;
      font-size: 2.2rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }
    
    .site-news-header h2 i {
      color: #00ff88;
      filter: drop-shadow(0 0 10px #00ff88);
    }
    
    .site-news-subtitle {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }
    
    .site-news-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }
    
    @media (max-width: 768px) {
      .site-news-grid {
        grid-template-columns: 1fr;
      }
    }
    
    .site-news-card {
      background: rgba(30, 15, 60, 0.8);
      border-radius: 15px;
      padding: 25px;
      border: 1px solid rgba(0, 255, 136, 0.3);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .site-news-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, #00ff88, #00ffaa);
    }
    
    .light-theme .site-news-card {
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(0, 255, 136, 0.2);
    }
    
    .site-news-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 255, 136, 0.3);
      border-color: rgba(0, 255, 136, 0.5);
    }
    
    .site-news-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(0, 255, 136, 0.2);
    }
    
    .site-news-title {
      color: #00ff88;
      font-weight: 600;
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .site-news-title i {
      font-size: 1.3rem;
    }
    
    .site-news-date {
      color: var(--text-secondary);
      font-size: 0.9rem;
      background: rgba(0, 0, 0, 0.2);
      padding: 5px 10px;
      border-radius: 15px;
    }
    
    .light-theme .site-news-date {
      background: rgba(0, 0, 0, 0.05);
    }
    
    .site-news-content {
      margin-bottom: 20px;
      line-height: 1.6;
      color: var(--text-primary);
    }
    
    .site-news-image {
      max-width: 100%;
      max-height: 250px;
      border-radius: 10px;
      margin: 15px 0;
      border: 1px solid rgba(0, 255, 136, 0.3);
      display: block;
    }
    
    .site-news-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid rgba(0, 255, 136, 0.2);
    }
    
    .site-news-id {
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-family: 'Orbitron', monospace;
    }
    
    .site-news-actions {
      display: flex;
      gap: 10px;
    }
    
    .site-news-btn {
      padding: 8px 15px;
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid rgba(0, 255, 136, 0.3);
      color: #00ff88;
      border-radius: 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .site-news-btn:hover {
      background: rgba(0, 255, 136, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 255, 136, 0.2);
    }
    
    .no-site-news {
      text-align: center;
      padding: 60px 20px;
      grid-column: 1 / -1;
    }
    
    .no-site-news i {
      font-size: 4rem;
      color: var(--primary);
      margin-bottom: 20px;
      display: block;
      opacity: 0.5;
    }
    
    .no-site-news h3 {
      color: var(--primary);
      margin-bottom: 15px;
      font-size: 1.8rem;
    }
    
    .no-site-news p {
      color: var(--text-secondary);
      margin-bottom: 25px;
      font-size: 1.1rem;
    }
    
    /* Кнопка создания новости для админа в модальном окне */
    .create-site-news-btn {
      background: linear-gradient(135deg, #00ff88 0%, #00ffaa 100%);
      border: none;
      color: #000;
      padding: 12px 25px;
      border-radius: 25px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 20px auto;
    }
    
    .create-site-news-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 255, 136, 0.4);
    }
    
    /* Стили для кнопки управления VK */
    .vk-management-section {
      text-align: center;
      margin: 20px 0;
    }
    
    .vk-management-link {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 25px;
      background: linear-gradient(135deg, #0077ff 0%, #00a2ff 50%, #00ddff 100%);
      color: white;
      text-decoration: none;
      border-radius: 25px;
      font-weight: 600;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 119, 255, 0.3);
    }
    
    .vk-management-link:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 119, 255, 0.5);
      background: linear-gradient(135deg, #00a2ff 0%, #00ddff 100%);
    }
    
    /* Стили для модального окна создания поста */
    .create-post-modal .modal-content {
      max-width: 600px;
      padding: 30px;
    }
    
    .create-post-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .create-post-form textarea {
      min-height: 150px;
      resize: vertical;
      padding: 15px;
      border-radius: 12px;
      border: 1px solid rgba(138, 43, 226, 0.4);
      background: rgba(255, 255, 255, 0.08);
      color: var(--text-primary);
      font-size: 1rem;
      font-family: 'Exo 2', sans-serif;
    }
    
    .create-post-form textarea:focus {
      outline: none;
      border-color: #00ff88;
      box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
    }
    
    .image-upload-section {
      border: 2px dashed rgba(0, 255, 136, 0.3);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .image-upload-section:hover {
      border-color: #00ff88;
      background: rgba(0, 255, 136, 0.05);
    }
    
    .image-upload-label {
      color: #00ff88;
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .image-preview {
      max-width: 100%;
      max-height: 200px;
      border-radius: 8px;
      margin-top: 15px;
      display: none;
    }
    
    .form-actions {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .btn-site-action {
      flex: 1;
      padding: 15px;
      background: linear-gradient(135deg, #00ff88 0%, #00ffaa 100%);
      border: none;
      color: #000;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.1rem;
    }
    
    .btn-site-action:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 255, 136, 0.4);
    }
    
    .char-count {
      text-align: right;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    
    /* VK посты (старые стили) */
    .vk-posts-container {
      max-height: 400px;
      overflow-y: auto;
      transition: max-height 0.3s ease;
    }
    
    .vk-posts-container.collapsed {
      max-height: 0;
      overflow: hidden;
    }
    
    .vk-posts-horizontal {
      display: flex;
      gap: 20px;
      padding: 10px;
      overflow-x: auto;
      min-height: 200px;
    }
    
    .vk-post-card {
      flex: 0 0 auto;
      width: 300px;
      background: rgba(26,15,56,0.8);
      border-radius: 15px;
      padding: 20px;
      border-left: 4px solid var(--primary);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      border: 1px solid var(--card-border);
    }
    
    .light-theme .vk-post-card {
      background: rgba(255, 255, 255, 0.8);
    }
    
    .vk-post-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(77, 0, 255, 0.3);
    }
    
    .vk-post-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .vk-post-date {
      color: #888;
      font-size: 0.9rem;
    }
    
    .vk-post-text {
      margin-bottom: 10px;
      line-height: 1.5;
      flex-grow: 1;
      color: var(--text-primary);
    }
    
    .vk-post-image {
      max-width: 100%;
      max-height: 150px;
      border-radius: 8px;
      border: 1px solid var(--primary);
      margin-bottom: 10px;
    }
    
    .vk-post-stats {
      display: flex;
      gap: 15px;
      color: #888;
      font-size: 0.9rem;
      margin-top: auto;
    }
    
    .toggle-posts-btn {
      background: var(--primary);
      color: var(--text-primary);
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.3s ease;
    }
    
    .toggle-posts-btn:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    /* Стили для ИИ-ассистента */
    .ai-assistant {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 1000;
    }
    
    .ai-assistant-toggle {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      border: 3px solid #fff;
      box-shadow: 0 8px 25px rgba(77, 0, 255, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: float 3s ease-in-out infinite;
    }
    
    .ai-assistant-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 30px rgba(77, 0, 255, 0.9);
    }
    
    .ai-assistant-toggle i {
      font-size: 28px;
      color: #fff;
    }
    
    .ai-chat-container {
      position: absolute;
      bottom: 90px;
      right: 0;
      width: 400px;
      height: 550px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6);
      border: 1px solid var(--primary);
      display: none;
      flex-direction: column;
      overflow: hidden;
      backdrop-filter: blur(10px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .ai-chat-container.active {
      display: flex;
    }
    
    .ai-chat-header {
      background: rgba(26, 15, 56, 0.95);
      padding: 20px;
      border-bottom: 1px solid var(--primary);
      display: flex;
      align-items: center;
      gap: 10px;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .ai-chat-header {
      background: rgba(255, 255, 255, 0.95);
    }
    
    .ai-chat-header img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid var(--primary);
    }
    
    .ai-chat-header h3 {
      color: var(--primary);
      font-size: 1.2rem;
    }
    
    .ai-chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .message {
      max-width: 85%;
      padding: 12px;
      border-radius: 12px;
      line-height: 1.4;
      animation: fadeIn 0.3s ease;
      color: var(--text-primary);
    }
    
    .user-message {
      align-self: flex-end;
      background: rgba(77, 0, 255, 0.3);
      border-bottom-right-radius: 4px;
    }
    
    .light-theme .user-message {
      background: rgba(77, 0, 255, 0.1);
    }
    
    .ai-message {
      align-self: flex-start;
      background: rgba(255, 255, 255, 0.1);
      border-bottom-left-radius: 4px;
    }
    
    .light-theme .ai-message {
      background: rgba(0, 0, 0, 0.05);
    }
    
    .ai-chat-input {
      display: flex;
      padding: 20px;
      border-top: 1px solid var(--primary);
      background: rgba(26, 15, 56, 0.95);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .ai-chat-input {
      background: rgba(255, 255, 255, 0.95);
    }
    
    .ai-chat-input input {
      flex: 1;
      padding: 12px;
      border: 1px solid var(--primary);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-size: 1rem;
    }
    
    .light-theme .ai-chat-input input {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }
    
    .ai-chat-input button {
      margin-left: 10px;
      padding: 12px 15px;
      background: var(--primary);
      border: none;
      border-radius: 8px;
      color: #ffffff;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
    }
    
    .ai-chat-input button:hover {
      background: var(--primary-light);
    }
    
    .quick-questions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 15px 20px;
      border-top: 1px solid rgba(77, 0, 255, 0.3);
      background: rgba(26, 15, 56, 0.8);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .quick-questions {
      background: rgba(255, 255, 255, 0.8);
    }
    
    .quick-question {
      padding: 8px 12px;
      background: rgba(77, 0, 255, 0.2);
      border: 1px solid rgba(77, 0, 255, 0.5);
      border-radius: 20px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #ffffff;
    }
    
    .light-theme .quick-question {
      background: rgba(77, 0, 255, 0.1);
      color: #333;
    }
    
    .quick-question:hover {
      background: rgba(77, 0, 255, 0.4);
      transform: translateY(-2px);
    }
    
    /* Стили для профиля */
    .profile-info {
      background: rgba(26, 15, 56, 0.9);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
      border: 1px solid var(--primary);
      box-shadow: 0 8px 25px rgba(77, 0, 255, 0.3);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .profile-info {
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 8px 25px rgba(77, 0, 255, 0.1);
    }
    
    .profile-field {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(77, 0, 255, 0.3);
    }
    
    .profile-field:last-child {
      border-bottom: none;
    }
    
    .profile-label {
      color: var(--primary);
      font-weight: 600;
      font-size: 1.1rem;
    }
    
    .profile-value {
      color: #ffffff;
      font-size: 1rem;
    }
    
    .light-theme .profile-value {
      color: #333;
    }
    
    .danger-zone {
      background: rgba(255, 107, 107, 0.1);
      border: 1px solid #ff6b6b;
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
    }
    
    .danger-zone h3 {
      color: #ff6b6b;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .delete-btn {
      background: linear-gradient(to right, #ff6b6b, #ff5252);
      border: none;
      color: white;
      padding: 12px 24px;
      font-weight: 600;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .delete-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
    }
    
    /* Стили для истории пользователей (админ) */
    .users-history {
      background: rgba(20, 10, 40, 0.9);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      border: 1px solid var(--primary);
      max-height: 300px;
      overflow-y: auto;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .users-history {
      background: rgba(255, 255, 255, 0.9);
    }
    
    .user-history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid rgba(77, 0, 255, 0.3);
    }
    
    .user-history-item:last-child {
      border-bottom: none;
    }
    
    /* Стили для чат-бота в углу */
    .chat-bot-corner {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 1000;
    }
    
    .chat-bot-toggle {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), #ff3366);
      border: 2px solid #fff;
      box-shadow: 0 4px 15px rgba(255, 0, 110, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: pulse-bot 2s ease-in-out infinite;
    }
    
    @keyframes pulse-bot {
      0% {
        transform: scale(1);
        box-shadow: 0 4px 15px rgba(255, 0, 110, 0.6);
      }
      50% {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(255, 0, 110, 0.8);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 4px 15px rgba(255, 0, 110, 0.6);
      }
    }
    
    .chat-bot-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 25px rgba(255, 0, 110, 0.9);
    }
    
    .chat-bot-toggle i {
      font-size: 24px;
      color: #fff;
    }
    
    .chat-bot-container {
      position: absolute;
      bottom: 75px;
      left: 0;
      width: 350px;
      height: 500px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
      border: 1px solid var(--accent);
      display: none;
      flex-direction: column;
      overflow: hidden;
      backdrop-filter: blur(10px);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .chat-bot-container.active {
      display: flex;
    }
    
    .chat-bot-header {
      background: rgba(56, 15, 56, 0.95);
      padding: 15px;
      border-bottom: 1px solid var(--accent);
      display: flex;
      align-items: center;
      gap: 10px;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .chat-bot-header {
      background: rgba(255, 255, 255, 0.95);
    }
    
    .chat-bot-header img {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 2px solid var(--accent);
    }
    
    .chat-bot-header h3 {
      color: var(--accent);
      font-size: 1.1rem;
    }
    
    .chat-bot-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .bot-message {
      max-width: 90%;
      padding: 10px;
      border-radius: 12px;
      line-height: 1.4;
      animation: fadeIn 0.3s ease;
      color: var(--text-primary);
      font-size: 0.9rem;
    }
    
    .bot-user-message {
      align-self: flex-end;
      background: rgba(255, 0, 110, 0.3);
      border-bottom-right-radius: 4px;
    }
    
    .light-theme .bot-user-message {
      background: rgba(255, 0, 110, 0.1);
    }
    
    .bot-ai-message {
      align-self: flex-start;
      background: rgba(255, 255, 255, 0.1);
      border-bottom-left-radius: 4px;
    }
    
    .light-theme .bot-ai-message {
      background: rgba(0, 0, 0, 0.05);
    }
    
    .chat-bot-input {
      display: flex;
      padding: 15px;
      border-top: 1px solid var(--accent);
      background: rgba(56, 15, 56, 0.95);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .chat-bot-input {
      background: rgba(255, 255, 255, 0.95);
    }
    
    .chat-bot-input input {
      flex: 1;
      padding: 10px;
      border: 1px solid var(--accent);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      font-size: 0.9rem;
    }
    
    .light-theme .chat-bot-input input {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }
    
    .chat-bot-input button {
      margin-left: 8px;
      padding: 10px 12px;
      background: var(--accent);
      border: none;
      border-radius: 8px;
      color: #ffffff;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
    }
    
    .chat-bot-input button:hover {
      background: #ff3366;
    }
    
    .bot-quick-questions {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      padding: 12px 15px;
      border-top: 1px solid rgba(255, 0, 110, 0.3);
      background: rgba(56, 15, 56, 0.8);
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .bot-quick-questions {
      background: rgba(255, 255, 255, 0.8);
    }
    
    .bot-quick-question {
      padding: 6px 10px;
      background: rgba(255, 0, 110, 0.2);
      border: 1px solid rgba(255, 0, 110, 0.5);
      border-radius: 15px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #ffffff;
    }
    
    .light-theme .bot-quick-question {
      background: rgba(255, 0, 110, 0.1);
      color: #333;
    }
    
    .bot-quick-question:hover {
      background: rgba(255, 0, 110, 0.4);
      transform: translateY(-2px);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Стили для истории обменов */
    .exchange-history {
      background: rgba(20, 10, 40, 0.9);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      border: 1px solid var(--primary);
      max-height: 300px;
      overflow-y: auto;
      transition: background 0.5s ease, color 0.5s ease;
    }
    
    .light-theme .exchange-history {
      background: rgba(255, 255, 255, 0.9);
    }
    
    .exchange-history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid rgba(77, 0, 255, 0.3);
    }
    
    .exchange-history-item:last-child {
      border-bottom: none;
    }
    
    .exchange-details {
      flex: 1;
    }
    
    .exchange-items {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 5px 0;
    }
    
    .exchange-arrow-small {
      color: var(--primary);
      font-size: 1rem;
    }
    
    .exchange-date {
      color: #888;
      font-size: 0.9rem;
    }
    
    .exchange-status {
      padding: 4px 8px;
      border-radius: 10px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .status-completed {
      background: rgba(76, 175, 80, 0.2);
      color: #4caf50;
    }
    
    .status-pending {
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
    }
    
    .status-failed {
      background: rgba(244, 67, 54, 0.2);
      color: #f44336;
    }
    
    /* Стили для выбора банка */
    .bank-selection {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .bank-option {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border: 1px solid rgba(138, 43, 226, 0.3);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .bank-option:hover {
      background: rgba(138, 43, 226, 0.1);
      border-color: var(--primary);
    }
    
    .bank-option.selected {
      background: rgba(138, 43, 226, 0.2);
      border-color: var(--primary);
    }
    
    .bank-logo {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      object-fit: cover;
    }
    
    /* Стили для выпавших предметов в профиле */
    .drop-items-list {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 15px;
    }
    
    .drop-item {
      background: linear-gradient(145deg, rgba(42, 26, 74, 0.8) 0%, rgba(31, 15, 63, 0.8) 100%);
      border-radius: 12px;
      padding: 15px;
      width: 180px;
      text-align: center;
      border: 1px solid var(--primary);
      transition: all 0.3s ease;
      position: relative;
    }
    
    .light-theme .drop-item {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 240, 255, 0.9) 100%);
    }
    
    .drop-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(77, 0, 255, 0.3);
    }
    
    .drop-item img {
      width: 100%;
      height: 100px;
      object-fit: contain;
      border-radius: 8px;
      margin-bottom: 10px;
      border: 1px solid var(--primary);
    }
    
    .drop-item-name {
      color: var(--text-primary);
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .drop-item-price {
      color: #ffd700;
      font-weight: 600;
      margin-bottom: 10px;
    }
    
    .claim-btn {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .claim-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    /* Стили для загрузки аватара */
    .avatar-upload {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .avatar-preview {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 3px solid var(--primary);
      overflow: hidden;
      position: relative;
      box-shadow: 0 0 15px rgba(77, 0, 255, 0.5);
    }
    
    .avatar-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .avatar-upload-btn {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .avatar-upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(77, 0, 255, 0.4);
    }
    
    /* Стили для переключения между пополнением и выводом */
    .balance-tabs {
      display: flex;
      margin-bottom: 20px;
      border-radius: 10px;
      overflow: hidden;
      background: rgba(138, 43, 226, 0.1);
    }
    
    .balance-tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }
    
    .balance-tab.active {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
    }
    
    .balance-tab:not(.active):hover {
      background: rgba(138, 43, 226, 0.2);
    }
    
    .balance-form {
      display: none;
    }
    
    .balance-form.active {
      display: block;
    }
    
    /* Стили для кнопки информации о предмете */
    .item-info-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: rgba(138, 43, 226, 0.8);
      border: none;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
      z-index: 5;
    }
    
    .item-info-btn:hover {
      background: var(--primary);
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(138, 43, 226, 0.7);
    }
    
    /* Модальное окно информации о предмете */
    .item-info-modal .modal-content {
      max-width: 500px;
    }
    
    .item-details {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .item-detail-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(138, 43, 226, 0.3);
    }
    
    .item-detail-label {
      color: var(--primary);
      font-weight: 600;
    }
    
    .item-detail-value {
      color: var(--text-primary);
    }
    
    .item-image-large {
      width: 100%;
      max-height: 200px;
      object-fit: contain;
      border-radius: 10px;
      border: 2px solid var(--primary);
      margin-bottom: 15px;
    }
    
    /* Водяной знак логотип, полупрозрачный и по центру экрана */
    .watermark {
      position: fixed;
      top: 50%;
      left: 50%;
      width: 300px;
      height: 300px;
      transform: translate(-50%, -50%);
      opacity: 0.03;
      pointer-events: none;
      user-select: none;
      z-index: 1;
      background: url('https://img.icons8.com/?size=100&id=gmWPXKWPTf64&format=png&color=000000') no-repeat center center;
      background-size: contain;
      animation: watermarkPulse 8s ease-in-out infinite alternate;
      filter: brightness(2);
    }
    
    @keyframes watermarkPulse {
      0% {
        opacity: 0.02;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
      }
      50% {
        opacity: 0.05;
        transform: translate(-50%, -50%) scale(1.05) rotate(2deg);
      }
      100% {
        opacity: 0.02;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
      }
    }
    
    /* Стили для текста Copyright с красивым шрифтом */
    .copyright-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: var(--text-primary);
      letter-spacing: 1px;
    }
    
    /* Медиа-запросы для мобильных устройств */
    @media (max-width: 768px) {
      .site-news-grid {
        grid-template-columns: 1fr;
      }
      
      .site-news-card {
        margin-bottom: 15px;
      }
      
      .vk-management-link {
        padding: 10px 20px;
        font-size: 1rem;
      }
      
      .create-post-modal .modal-content {
        width: 95%;
        padding: 20px;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .btn-site-action {
        width: 100%;
      }
    }
  </style>
</head>
<body
  oncopy="return false;"
  oncut="return false;"
  onpaste="return false;"
  oncontextmenu="return false;"
  onselectstart="return false;"
  ondragstart="return false;"
>
  <!-- Киберпанк заставка -->
  <div class="cyberpunk-loader" id="cyberpunkLoader">
    <div class="cyber-grid" id="cyberGrid"></div>
    <img src="https://img.icons8.com/?size=100&id=gmWPXKWPTf64&format=png&color=000000" alt="Логотип" class="cyber-logo" />
    <div class="cyber-text">Обмен Феникса</div>
    <div class="cyber-subtitle">Киберпанк платформа обмена</div>
    <div class="loading-bar">
      <div class="loading-progress"></div>
    </div>
    <div class="hacking-text" id="hackingText">
      <!-- Текст будет добавлен через JS -->
    </div>
  </div>

  <!-- Частицы фона -->
  <div class="particles" id="particles"></div>
  
  <!-- Модальные окна для входа и регистрации -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('loginModal')">&times;</span>
      <h2>Вход в систему</h2>
      <form id="loginForm">
        <div class="form-group">
          <label for="loginEmail">Email:</label>
          <input type="email" id="loginEmail" required>
        </div>
        <div class="form-group">
          <label for="loginPassword">Пароль:</label>
          <input type="password" id="loginPassword" required>
        </div>
        <button type="submit" class="submit-btn">Войти</button>
      </form>
      <div class="switch-form">
        Нет аккаунта? <a onclick="switchToRegister()">Зарегистрироваться</a>
      </div>
    </div>
  </div>

  <div id="registerModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('registerModal')">&times;</span>
      <h2>Регистрация</h2>
      <form id="registerForm">
        <div class="form-group">
          <label for="registerName">Имя:</label>
          <input type="text" id="registerName" required>
        </div>
        <div class="form-group">
          <label for="registerEmail">Email:</label>
          <input type="email" id="registerEmail" required>
        </div>
        <div class="form-group">
          <label for="registerPassword">Пароль:</label>
          <input type="password" id="registerPassword" required>
        </div>
        <div class="form-group">
          <label for="registerConfirmPassword">Подтвердите пароль:</label>
          <input type="password" id="registerConfirmPassword" required>
        </div>
        <button type="submit" class="submit-btn">Зарегистрироваться</button>
      </form>
      <div class="switch-form">
        Уже есть аккаунт? <a onclick="switchToLogin()">Войти</a>
      </div>
    </div>
  </div>

  <!-- НОВОЕ МОДАЛЬНОЕ ОКНО ДЛЯ НОВОСТЕЙ НА САЙТЕ -->
  <div id="siteNewsModal" class="modal site-news-modal">
    <div class="modal-content extra-large">
      <span class="close" onclick="closeModal('siteNewsModal')">&times;</span>
      
      <div class="site-news-header">
        <h2><i class="fas fa-newspaper"></i> Новости на сайте</h2>
        <p class="site-news-subtitle">Актуальные новости и обновления платформы</p>
        
        <!-- Кнопка создания новости для админа -->
        <button class="create-site-news-btn" id="createSiteNewsBtn" onclick="showCreatePostModal()" style="display: none;">
          <i class="fas fa-plus-circle"></i> Создать новость
        </button>
      </div>
      
      <div class="site-news-container">
        <div class="site-news-grid" id="siteNewsContainer">
          <!-- Новости будут загружаться через JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Модальное окно создания поста -->
  <div id="createPostModal" class="modal create-post-modal">
    <div class="modal-content large">
      <span class="close" onclick="closeModal('createPostModal')">&times;</span>
      <h2><i class="fas fa-plus-circle"></i> Создать новость на сайте</h2>
      <form class="create-post-form" id="createPostForm">
        <div class="form-group">
          <label for="postTitle">Заголовок новости:</label>
          <input type="text" id="postTitle" placeholder="Введите заголовок новости..." maxlength="100" required>
        </div>
        
        <div class="form-group">
          <label for="postContent">Текст новости:</label>
          <textarea id="postContent" placeholder="Введите текст новости..." maxlength="2000" required></textarea>
          <div class="char-count">
            <span id="postCharCount">0</span>/2000 символов
          </div>
        </div>
        
        <div class="form-group">
          <label>Изображение (опционально):</label>
          <div class="image-upload-section" id="imageUploadSection">
            <label class="image-upload-label" for="postImage">
              <i class="fas fa-image"></i> Нажмите для загрузки изображения
            </label>
            <input type="file" id="postImage" accept="image/*" style="display: none;">
            <img id="imagePreview" class="image-preview" alt="Предпросмотр изображения">
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="btn-site-action">
            <i class="fas fa-paper-plane"></i> Опубликовать новость
          </button>
          <button type="button" class="btn-secondary" onclick="closeModal('createPostModal')">
            <i class="fas fa-times"></i> Отмена
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Модальное окно профиля -->
  <div id="profileModal" class="modal">
    <div class="modal-content extra-large">
      <span class="close" onclick="closeModal('profileModal')">&times;</span>
      <h2>Мой профиль</h2>
      <div id="profileContent">
        <!-- Профиль будет заполнен JavaScript -->
      </div>
    </div>
  </div>

  <!-- Модальное окно баланса -->
  <div id="balanceModal" class="modal">
    <div class="modal-content large">
      <span class="close" onclick="closeModal('balanceModal')">&times;</span>
      <h2>Управление балансом</h2>
      
      <div class="balance-tabs">
        <div class="balance-tab active" onclick="switchBalanceTab('deposit')">Пополнить</div>
        <div class="balance-tab" onclick="switchBalanceTab('withdraw')">Вывести</div>
      </div>
      
      <!-- Форма пополнения баланса -->
      <form id="depositForm" class="balance-form active">
        <div class="form-group">
          <label>Выберите банк:</label>
          <div class="bank-selection" id="depositBankSelection">
            <div class="bank-option" data-bank="sber">
              <img src="https://avatars.mds.yandex.net/i?id=a5163d108af1d885ebc63858ba8562b2_l-16110459-images-thumbs&n=13" alt="Сбербанк" class="bank-logo">
              <span>Сбербанк</span>
            </div>
            <div class="bank-option" data-bank="tinkoff">
              <img src="https://avatars.mds.yandex.net/i?id=d512b40969d5ae288bd37de8d6538a2d_l-4571053-images-thumbs&n=13" alt="Тинькофф" class="bank-logo">
              <span>Тинькофф</span>
            </div>
            <div class="bank-option" data-bank="vtb">
              <img src="https://fondpr.ru/image/iex-O6mpY3rIck.png" alt="ВТБ" class="bank-logo">
              <span>ВТБ</span>
            </div>
            <div class="bank-option" data-bank="alfa">
              <img src="https://i.pinimg.com/736x/48/66/a4/4866a4d8cfdd47d8fee3a482d5a34e28.jpg" alt="Альфа-Банк" class="bank-logo">
              <span>Альфа-Банк</span>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label for="cardNumber">Номер карты:</label>
          <input type="text" id="cardNumber" placeholder="0000 0000 0000 0000" maxlength="19" required>
        </div>
        <div class="form-group">
          <label for="cardExpiry">Срок действия (ММ/ГГ):</label>
          <input type="text" id="cardExpiry" placeholder="ММ/ГГ" maxlength="5" required>
        </div>
        <div class="form-group">
          <label for="cardCVV">CVV:</label>
          <input type="text" id="cardCVV" placeholder="000" maxlength="3" required>
        </div>
        <div class="form-group">
          <label for="amount">Сумма пополнения (руб):</label>
          <input type="number" id="amount" min="100" max="50000" value="1000" required>
        </div>
        <button type="submit" class="submit-btn">Пополнить баланс</button>
      </form>
      
      <!-- Форма вывода средств -->
      <form id="withdrawForm" class="balance-form">
        <div class="form-group">
          <label>Выберите банк:</label>
          <div class="bank-selection" id="bankSelection">
            <div class="bank-option" data-bank="sber">
              <img src="https://avatars.mds.yandex.net/i?id=a5163d108af1d885ebc63858ba8562b2_l-16110459-images-thumbs&n=13" alt="Сбербанк" class="bank-logo">
              <span>Сбербанк</span>
            </div>
            <div class="bank-option" data-bank="tinkoff">
              <img src="https://avatars.mds.yandex.net/i?id=d512b40969d5ae288bd37de8d6538a2d_l-4571053-images-thumbs&n=13" alt="Тинькофф" class="bank-logo">
              <span>Тинькофф</span>
            </div>
            <div class="bank-option" data-bank="vtb">
              <img src="https://fondpr.ru/image/iex-O6mpY3rIck.png" alt="ВТБ" class="bank-logo">
              <span>ВТБ</span>
            </div>
            <div class="bank-option" data-bank="alfa">
              <img src="https://i.pinimg.com/736x/48/66/a4/4866a4d8cfdd47d8fee3a482d5a34e28.jpg" alt="Альфа-Банк" class="bank-logo">
              <span>Альфа-Банк</span>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label for="withdrawCardNumber">Номер карты:</label>
          <input type="text" id="withdrawCardNumber" placeholder="0000 0000 0000 0000" maxlength="19" required>
        </div>
        <div class="form-group">
          <label for="withdrawAmount">Сумма вывода (руб):</label>
          <input type="number" id="withdrawAmount" min="100" max="50000" value="1000" required>
        </div>
        <button type="submit" class="submit-btn">Вывести средства</button>
      </form>
    </div>
  </div>

  <!-- Модальное окно колеса фортуны -->
  <div id="fortuneModal" class="modal fortune-modal">
    <div class="modal-content large">
      <span class="close" onclick="closeModal('fortuneModal')">&times;</span>
      <h2>Колесо Фортуны</h2>
      <div class="fortune-container">
        <div class="wheel-container">
          <div class="wheel" id="fortuneWheel">
            <!-- Секции колеса будут добавлены через JS -->
          </div>
          <div class="wheel-center">
            <i class="fas fa-gem"></i>
          </div>
          <div class="wheel-pointer"></div>
        </div>
        <button class="spin-button" id="spinButton" onclick="spinWheel()">Крутить колесо!</button>
        <div class="fortune-timer" id="fortuneTimer"></div>
        <div class="fortune-result" id="fortuneResult" style="display: none;">
          <!-- Результат будет показан здесь -->
        </div>
      </div>
    </div>
  </div>

  <!-- Модальное окно информации о предмете -->
  <div id="itemInfoModal" class="modal item-info-modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('itemInfoModal')">&times;</span>
      <h2>Информация о предмете</h2>
      <div id="itemInfoContent">
        <!-- Информация о предмете будет заполнена через JS -->
      </div>
    </div>
  </div>

  <!-- Модальное окно новостей ВК -->
  <div id="vkNewsModal" class="modal">
    <div class="modal-content extra-large">
      <span class="close" onclick="closeModal('vkNewsModal')">&times;</span>
      <h2>Новости ВКонтакте</h2>
      <div class="vk-posts-container" id="vkPostsContainer">
        <div id="vkPostsList" class="vk-posts-horizontal"></div>
      </div>
    </div>
  </div>

  <header>
    <div class="header-content" onclick="goToMainPage()">
      <img src="https://img.icons8.com/?size=100&id=gmWPXKWPTf64&format=png&color=000000" alt="Логотип обмена Феникса" />
      Обмен Феникса
    </div>
    <div class="user-section">
      <!-- Кнопка переключения темы -->
      <div class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
        <i class="fas fa-moon"></i>
      </div>
      
      <!-- КНОПКА УПРАВЛЕНИЯ VK ДЛЯ АДМИНОВ -->
      <button class="vk-management-btn" id="vkManagementBtn" onclick="openVKManagement()" style="display: none;">
        <i class="fab fa-vk"></i> Управление VK
      </button>
      
      <div id="userInfo" class="user-info" style="display: none;">
        <img id="headerAvatar" src="https://img.icons8.com/?size=100&id=109512&format=png&color=000000" alt="Аватар" class="user-avatar" onclick="showProfile()">
        <span id="userName"></span>
        <div class="fortune-icon" onclick="showFortuneModal()" title="Колесо Фортуны">
          <i class="fas fa-dice"></i>
        </div>
        <div class="balance-section" onclick="showBalanceModal()">
          <i class="fas fa-wallet"></i>
          <span class="balance-amount" id="userBalance">0 ₽</span>
        </div>
        <span id="adminBadge" class="admin-badge" style="display: none;">ADMIN</span>
        <button class="auth-btn" onclick="logout()">Выйти</button>
      </div>
      <div id="authButtons" class="auth-buttons">
        <button class="auth-btn" onclick="showLogin()">Войти</button>
        <button class="auth-btn" onclick="showRegister()">Регистрация</button>
      </div>
    </div>
  </header>

  <nav id="mainNav">
    <!-- Навигация будет обновляться в зависимости от роли пользователя -->
  </nav>

  <!-- Баннер для неавторизованных пользователей -->
  <div class="banner-section" id="bannerSection">
    <div class="banner-container">
      <div class="banner-slide active" id="slide1" style="background-image: url('https://sun9-67.userapi.com/s/v1/if2/QGZY4Vq5F1w5jwNECMJBuUpn2ePkDfEHs5ZpRVMQiesXLAxvl7AvEbJhudv1wNevW1_-aYHHBLZFErIZ3r-1aMlh.jpg?quality=95&as=32x10,48x14,72x21,108x32,160x48,240x72,360x107,480x143,540x161,640x191,720x215,1080x322,1280x381,1440x429,2560x763&from=bu&cs=2560x0');">
        
      </div>
      <div class="banner-slide" id="slide2" style="background-image: url('https://sun9-20.userapi.com/s/v1/if2/sVIWff0k8BiFRMNuXWL7vQCpEMFPzzxzmyz_lL_H38QahQ9CY2tsxfquLwLXANHGChGzs_s0SA-H8kA-4Da0_MUn.jpg?quality=95&as=32x9,48x13,72x20,108x30,160x45,240x67,360x100,480x134,540x150,640x178,720x201,1080x301,1242x346&from=bu&cs=1242x0');">
      
      </div>
      <div class="banner-slide" id="slide3" style="background-image: url('https://sun9-38.userapi.com/s/v1/if2/HIHhp9URB1s0BU5504u6Vu7snHd6XIlP46FUUKpCQSavxaDS1xqQG7SyuM4roJLax5TT5ku8hpKcOUCU9fEDAfso.jpg?quality=95&as=32x10,48x15,72x22,108x33,160x49,240x73,360x110,480x146,540x164,640x195,720x219,1080x329,1280x389,1440x438,2560x779&from=bu&cs=2560x0');">
        
      </div>
      
      <button class="banner-arrow prev" onclick="changeBannerSlide(-1)">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="banner-arrow next" onclick="changeBannerSlide(1)">
        <i class="fas fa-chevron-right"></i>
      </button>
      
      <div class="banner-controls">
        <div class="banner-dot active" onclick="setBannerSlide(0)"></div>
        <div class="banner-dot" onclick="setBannerSlide(1)"></div>
        <div class="banner-dot" onclick="setBannerSlide(2)"></div>
      </div>
    </div>
  </div>

  <!-- Секция с колесом фортуны - СКРЫТА -->
  <div class="fortune-section" id="fortuneSection">
    <h2>Колесо Фортуны</h2>
    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">Крутите колесо каждый день и получайте случайные предметы!</p>
    <div class="fortune-container">
      <div class="wheel-container">
        <div class="wheel" id="mainFortuneWheel">
          <!-- Секции колеса будут добавлены через JS -->
        </div>
        <div class="wheel-center">
          <i class="fas fa-gem"></i>
        </div>
        <div class="wheel-pointer"></div>
      </div>
      <button class="spin-button" id="mainSpinButton" onclick="spinMainWheel()">Крутить колесо!</button>
      <div class="fortune-timer" id="mainFortuneTimer"></div>
      <div class="fortune-result" id="mainFortuneResult" style="display: none;">
        <!-- Результат будет показан здесь -->
      </div>
    </div>
  </div>

  <!-- Плавущая строка для авторизованных пользователей -->
  <div class="scrolling-list-wrapper" id="scrollingSection" style="display: none;">
    <div class="scrolling-list" id="scrollingList">
      <!-- наполняется JS -->
    </div>
  </div>

  <!-- Секция выбранных предметов -->
  <div class="selected-items-section" id="selectedItemsSection" style="display: none;">
    <h2 style="color: var(--primary); text-align: center; margin-bottom: 25px; font-family: 'Orbitron', sans-serif;">Выбранные предметы для обмена</h2>
    <div class="selected-items-grid">
      <div class="selected-items-column">
        <h3 style="color: var(--primary); text-align: center;">Мои предметы</h3>
        <div class="selected-items-list" id="selectedOfferItems">
          <!-- Выбранные предметы для обмена будут здесь -->
        </div>
        <div class="exchange-summary">
          <div class="summary-item">Количество: <span id="offerCount">0</span></div>
          <div class="summary-item">Общая стоимость: <span id="offerTotal">0 ₽</span></div>
        </div>
      </div>
      
      <div class="exchange-summary" style="display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 20px;">
        <div class="exchange-arrow">
          <i class="fas fa-exchange-alt"></i>
        </div>
        <div class="summary-total" id="exchangeDifference">Разница: 0 ₽</div>
        <button id="exchangeButton" class="submit-btn" style="width: 200px; margin: 0;">
          Обменять
        </button>
      </div>
      
      <div class="selected-items-column">
        <h3 style="color: var(--primary); text-align: center;">Получаемые предметы</h3>
        <div class="selected-items-list" id="selectedWantItems">
          <!-- Выбранные получаемые предметы будут здесь -->
        </div>
        <div class="exchange-summary">
          <div class="summary-item">Количество: <span id="wantCount">0</span></div>
          <div class="summary-item">Общая стоимость: <span id="wantTotal">0 ₽</span></div>
        </div>
      </div>
    </div>
  </div>

  <main>
    <section id="mine" style="display: none;">
      <h2>Мои предметы</h2>
      <div class="items-list" id="myItemsList"></div>
    </section>

    <!-- Фильтры между секциями -->
    <div class="filters-section">
      <h2 style="color: var(--primary); text-align: center; margin-bottom: 25px; font-family: 'Orbitron', sans-serif;">Фильтры</h2>
      <div class="filters-grid">
        <div class="filter-group">
          <label class="filter-label">Цена</label>
          <div class="price-inputs">
            <div class="price-input-row">
              <input type="number" id="minPrice" placeholder="0.00" min="0" step="0.01">
            </div>
            <div class="price-separator">-</div>
            <div class="price-input-row">
              <input type="number" id="maxPrice" placeholder="∞" min="0" step="0.01">
            </div>
          </div>
        </div>
        <div class="filter-group">
          <label class="filter-label">Тип</label>
          <select class="filter-select" id="typeFilter">
            <option value="">Все типы</option>
            <option value="weapon">Оружие</option>
            <option value="armor">Броня</option>
            <option value="potion">Зелья</option>
            <option value="accessory">Аксессуары</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Качество</label>
          <select class="filter-select" id="qualityFilter">
            <option value="">Любое качество</option>
            <option value="common">Обычное</option>
            <option value="uncommon">Необычное</option>
            <option value="rare">Редкое</option>
            <option value="epic">Эпическое</option>
            <option value="legendary">Легендарное</option>
          </select>
        </div>
        <div class="filter-group">
          <label class="filter-label">Редкость</label>
          <select class="filter-select" id="rarityFilter">
            <option value="">Любая редкость</option>
            <option value="common">Частый</option>
            <option value="uncommon">Нечастый</option>
            <option value="rare">Редкий</option>
            <option value="mythical">Мифический</option>
            <option value="immortal">Бессмертный</option>
          </select>
        </div>
      </div>
      <button class="save-filters-btn" onclick="saveFilters()">
        <i class="fas fa-save"></i> Сохранить фильтры
      </button>
    </div>

    <section id="exchange">
      <h2>Предметы для обмена</h2>
      <div class="items-list" id="exchangeItemsList"></div>
    </section>
  </main>

  <!-- Чат-бот в левом нижнем углу -->
  <div class="chat-bot-corner">
    <div class="chat-bot-container" id="chatBotContainer">
      <div class="chat-bot-header">
        <img src="https://sun9-76.userapi.com/s/v1/ig2/dvFpPtF87NB2OpRvxBGdO1sBRWINdqpm6mX3zFMzMuT3PzMOPXFN09MAJSdup3Ev4vngpz3QqfCB6AQkHr60KhTl.jpg?quality=95&as=32x32,48x48,72x72,96x96&from=bu&cs=96x0" alt="Чат-бот" />
        <h3>Помощник Феникс</h3>
      </div>
      <div class="chat-bot-messages" id="chatBotMessages">
        <div class="bot-message bot-ai-message">
          Привет! Я ваш помощник на платформе Феникс. Задайте мне любой вопрос! 😊
        </div>
      </div>
      <div class="bot-quick-questions">
        <div class="bot-quick-question" onclick="askBotQuickQuestion(this)">Привет</div>
        <div class="bot-quick-question" onclick="askBotQuickQuestion(this)">Как обмениваться?</div>
        <div class="bot-quick-question" onclick="askBotQuickQuestion(this)">Правила</div>
        <div class="bot-quick-question" onclick="askBotQuickQuestion(this)">Поддержка</div>
        <div class="bot-quick-question" onclick="askBotQuickQuestion(this)">Шутка</div>
      </div>
      <div class="chat-bot-input">
        <input type="text" id="chatBotInput" placeholder="Напишите сообщение..." />
        <button onclick="sendBotMessage()"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
    <div class="chat-bot-toggle" id="chatBotToggle">
      <i class="fas fa-robot"></i>
    </div>
  </div>

  <!-- ИИ-ассистент -->
  <div class="ai-assistant">
    <div class="ai-chat-container" id="aiChatContainer">
      <div class="ai-chat-header">
        <img src="https://img.icons8.com/?size=100&id=gmWPXKWPTf64&format=png&color=000000" alt="ИИ ассистент" />
        <h3>ИИ-помощник ФЕНИКС</h3>
      </div>
      <div class="ai-chat-messages" id="aiChatMessages">
        <div class="message ai-message">
          Привет! Я ваш ИИ-помощник на платформе ФЕНИКС. Чем могу помочь?
        </div>
      </div>
      <div class="quick-questions">
        <div class="quick-question" onclick="askQuickQuestion(this)">Как обмениваться?</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Безопасность сделок</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Правила платформы</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Популярные предметы</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Время обработки</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Поддержка</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Статус заявки</div>
        <div class="quick-question" onclick="askQuickQuestion(this)">Отмена обмена</div>
      </div>
      <div class="ai-chat-input">
        <input type="text" id="aiChatInput" placeholder="Задайте ваш вопрос..." />
        <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
    <div class="ai-assistant-toggle" id="aiAssistantToggle">
      <i class="fas fa-robot"></i>
    </div>
  </div>

  <!-- Водяной знак логотип -->
  <div class="watermark" aria-hidden="true"></div>

  <footer id="contacts">
    <!-- Обновленный текст Copyright с красивым шрифтом -->
    <p class="copyright-text">Copyright Logan2020 2025</p>
    <p>Платформа обмена игровыми элементами. Все права защищены.</p>
    <p>Контакты:
      <a href="mailto:support@gameswap.ru" style="color: var(--primary);">support@gameswap.ru</a> | +7 (999) 123-45-67
    </p>
    <div class="social-icons">
      <a href="https://vk.com/club233612410" target="_blank" aria-label="ВКонтакте"><i class="fab fa-vk"></i></a>
      <a href="https://rutube.ru/" aria-label="RuTube"><i class="fab fa-youtube"></i></a>
    </div>
  </footer>

  <script>
    // Глобальные переменные
    let postsExpanded = true;
    let chatOpen = false;
    let botOpen = false;
    let currentUser = null;
    let selectedOfferItems = [];
    let selectedWantItems = [];
    let currentBannerSlide = 0;
    let bannerInterval;
    let exchangeHistory = JSON.parse(localStorage.getItem('exchangeHistory') || '[]');
    let userInventory = JSON.parse(localStorage.getItem('userInventory') || '[]');
    let wheelSpinning = false;
    let lastSpinTime = localStorage.getItem('lastFortuneSpin') || 0;
    let balanceMenuOpen = false;
    let isLightTheme = localStorage.getItem('isLightTheme') === 'true';
    
    // Хранилище для постов на сайте
    let sitePosts = JSON.parse(localStorage.getItem('site_posts') || '[]');

    // Функция для гарантированного создания администратора
    function ensureAdminExists() {
      let users = JSON.parse(localStorage.getItem('users') || '[]');
      
      // Проверяем, существует ли администратор
      const adminExists = users.some(user => user.email === 'admin@ya.ru');
      
      if (!adminExists) {
        console.log('Создаем администратора по умолчанию...');
        users.push({
          id: 1,
          name: 'Администратор',
          email: 'admin@ya.ru',
          password: 'admin123',
          role: 'admin',
          avatar: 'https://img.icons8.com/?size=100&id=109512&format=png&color=000000',
          registrationDate: new Date().toISOString(),
          balance: 10000,
          inventory: [],
          dropItems: []
        });
        localStorage.setItem('users', JSON.stringify(users));
        console.log('Администратор создан: admin@ya.ru / admin123');
      } else {
        console.log('Администратор уже существует');
      }
      
      return users;
    }

    // Система пользователей - используем функцию гарантии
    let users = ensureAdminExists();
    
    // История входов пользователей
    let usersHistory = JSON.parse(localStorage.getItem('usersHistory') || '[]');

    // ФУНКЦИЯ: Открытие управления VK
    function openVKManagement() {
      window.open('vk.html', '_blank');
    }

    // ФУНКЦИЯ: Показать модальное окно новостей сайта
    function showSiteNewsModal() {
      const modal = document.getElementById('siteNewsModal');
      modal.style.display = 'block';
      
      // Загружаем новости
      loadSiteNews();
    }

    // ФУНКЦИЯ: Показать модальное окно создания поста
    function showCreatePostModal() {
      closeModal('siteNewsModal'); // Закрываем модальное окно новостей
      const modal = document.getElementById('createPostModal');
      modal.style.display = 'block';
      
      // Сбросить форму
      document.getElementById('postTitle').value = '';
      document.getElementById('postContent').value = '';
      document.getElementById('postCharCount').textContent = '0';
      document.getElementById('imagePreview').style.display = 'none';
      document.getElementById('imagePreview').src = '';
    }

    // ФУНКЦИЯ: Загрузка новостей сайта в модальное окно
    function loadSiteNews() {
      const container = document.getElementById('siteNewsContainer');
      
      // Показываем/скрываем кнопку создания новости для админа
      const createNewsBtn = document.getElementById('createSiteNewsBtn');
      if (currentUser && currentUser.role === 'admin') {
        createNewsBtn.style.display = 'block';
      } else {
        createNewsBtn.style.display = 'none';
      }
      
      if (!sitePosts || sitePosts.length === 0) {
        container.innerHTML = `
          <div class="no-site-news">
            <i class="fas fa-newspaper"></i>
            <h3>Новостей пока нет</h3>
            <p>Будьте первым, кто поделится новостью!</p>
            ${currentUser && currentUser.role === 'admin' ? 
              `<button class="create-site-news-btn" onclick="showCreatePostModal()">
                <i class="fas fa-plus-circle"></i> Создать первую новость
              </button>` : ''}
          </div>
        `;
        return;
      }
      
      let postsHTML = '';
      
      sitePosts.forEach(post => {
        let imageHTML = '';
        if (post.image) {
          imageHTML = `<img src="${post.image}" class="site-news-image" alt="Изображение новости">`;
        } else if (post.photoPreview) {
          imageHTML = `<img src="${post.photoPreview}" class="site-news-image" alt="Изображение новости">`;
        }
        
        let text = post.text || post.content || '';
        
        postsHTML += `
          <div class="site-news-card" data-id="${post.id}">
            <div class="site-news-card-header">
              <div class="site-news-title">
                <i class="fas fa-bullhorn"></i> ${post.title || 'Новость'}
              </div>
              <div class="site-news-date">${post.date || new Date(post.timestamp).toLocaleString('ru-RU')}</div>
            </div>
            <div class="site-news-content">${text}</div>
            ${imageHTML}
            <div class="site-news-footer">
              <div class="site-news-id">ID: ${post.id}</div>
              <div class="site-news-actions">
                ${currentUser && currentUser.role === 'admin' ? 
                  `<button class="site-news-btn" onclick="deleteSitePost(${post.id})">
                    <i class="fas fa-trash"></i> Удалить
                  </button>` : ''}
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = postsHTML;
    }

    // ФУНКЦИЯ: Создание поста на сайте
    function createSitePost(event) {
      event.preventDefault();
      
      const title = document.getElementById('postTitle').value.trim();
      const content = document.getElementById('postContent').value.trim();
      const imagePreview = document.getElementById('imagePreview');
      
      if (!title || !content) {
        alert('Пожалуйста, заполните заголовок и текст новости');
        return;
      }
      
      const newPost = {
        id: Date.now(),
        title: title,
        content: content,
        text: content, // для совместимости
        timestamp: new Date().toISOString(),
        date: new Date().toLocaleString('ru-RU'),
        type: 'site_post'
      };
      
      // Добавляем изображение если есть
      if (imagePreview.src) {
        newPost.image = imagePreview.src;
        newPost.photoPreview = imagePreview.src;
      }
      
      // Добавляем в начало массива
      sitePosts.unshift(newPost);
      
      // Сохраняем в localStorage
      localStorage.setItem('site_posts', JSON.stringify(sitePosts));
      
      // Закрываем модальное окно
      closeModal('createPostModal');
      
      // Показываем уведомление
      alert('Новость успешно опубликована на сайте!');
      
      // Показываем модальное окно новостей с обновленным списком
      showSiteNewsModal();
    }

    // ФУНКЦИЯ: Удаление поста с сайта
    function deleteSitePost(postId) {
      if (!confirm('Вы уверены, что хотите удалить эту новость?')) {
        return;
      }
      
      // Фильтруем посты
      sitePosts = sitePosts.filter(post => post.id !== postId);
      
      // Сохраняем в localStorage
      localStorage.setItem('site_posts', JSON.stringify(sitePosts));
      
      // Обновляем отображение
      loadSiteNews();
      
      alert('Новость успешно удалена!');
    }

    // ФУНКЦИЯ: Инициализация загрузки изображений
    function initImageUpload() {
      const imageUpload = document.getElementById('postImage');
      const imagePreview = document.getElementById('imagePreview');
      const imageUploadSection = document.getElementById('imageUploadSection');
      
      imageUpload.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            imagePreview.src = e.target.result;
            imagePreview.style.display = 'block';
          };
          
          reader.readAsDataURL(file);
        }
      });
      
      imageUploadSection.addEventListener('click', function() {
        imageUpload.click();
      });
    }

    // Локальный бот с расширенными возможностями
    const localBot = {
      name: "Помощник Феникс",
      responses: {
        // Приветствия
        greeting: [
          "Привет! Рад видеть вас на платформе Феникс! 😊",
          "Здравствуйте! Чем могу помочь?",
          "Приветствую! Готов ответить на ваши вопросы!",
          "Добро пожаловать! Как ваши дела?",
          "Привет! Как проходит ваш день?"
        ],
        
        // Прощания
        farewell: [
          "До свидания! Удачи в обменах! 🚀",
          "Пока! Возвращайтесь скорее!",
          "Всего хорошего! Если будут вопросы - я тут!",
          "До скорой встречи! Не пропадайте!",
          "Пока-пока! Желаю успешных сделок!"
        ],
        
        // Благодарности
        thanks: [
          "Пожалуйста! Всегда рад помочь! 😊",
          "Не за что! Обращайтесь еще!",
          "Рад был помочь! Удачи в обменах!",
          "На здоровье! Если что - я рядом!",
          "Всегда пожалуйста! Чем еще помочь?"
        ],
        
        // Вопросы о платформе
        platform: [
          "Феникс - это безопасная платформа для обмена игровыми предметами с системой рейтинга и модерацией всех сделок!",
          "Наша платформа обеспечивает безопасный обмен предметами между игроками с гарантией выполнения сделок!",
          "Феникс создан для удобного и безопасного обмена игровыми ценностями с минимальной комиссией!"
        ],
        
        // Вопросы о функционале
        functionality: [
          "Вы можете обмениваться предметами, просматривать историю сделок, пополнять баланс и многое другое!",
          "Основные функции: обмен предметами, система рейтинга, пополнение баланса, история операций!",
          "На платформе доступен обмен, покупка/продажа предметов, участие в аукционах и многое другое!"
        ],
        
        // Вопросы о безопасности
        security: [
          "Все сделки защищены системой escrow, модерацией и рейтинговой системой для вашей безопасности!",
          "Мы используем многоуровневую систему безопасности: верификацию пользователей, модерацию сделок и защиту от мошенников!",
          "Ваши данные и сделки защищены современными методами шифрования и системой репутации пользователей!"
        ],
        
        // Вопросы о поддержке
        support: [
          "Служба поддержки доступна 24/7 по email: support@fenix-exchange.ru или через онлайн-чат!",
          "Наша поддержка работает круглосуточно! Пишите на support@fenix-exchange.ru или в телеграм @fenix_support!",
          "По всем вопросам обращайтесь в поддержку: support@fenix-exchange.ru или +7 (999) 123-45-67"
        ],
        
        // Вопросы о комиссии
        commission: [
          "Комиссия платформы составляет всего 5% от стоимости обмена! Для премиум-пользователей - 3%!",
          "Базовая комиссия - 5%, но при активном использовании платформы она может снижаться!",
          "Мы берем минимальную комиссие 5% для поддержания работы платформы и обеспечения безопасности!"
        ],
        
        // Вопросы о времени обработки
        processing: [
          "Обычные обмены обрабатываются в течение 1-24 часов, срочные - до 1 часа!",
          "Время обработки зависит от типа операции: обычные сделки - до 24 часов, премиум - до 1 часа!",
          "Мы стараемся обрабатывать все заявки максимально быстро! Обычно это занимает от 1 до 24 часов!"
        ],
        
        // Общие вопросы
        general: [
          "Интересный вопрос! Дайте мне подумать... 🤔",
          "Хм, хороший вопрос! Позвольте мне уточнить детали...",
          "Отличный вопрос! Давайте разберемся вместе!",
          "Интересно! Давайте обсудим этот вопрос подробнее!",
          "Вопрос требует внимательного рассмотрения! Думаю над ответом..."
        ],
        
        // Непонятные вопросы
        unknown: [
          "Извините, я не совсем понял ваш вопрос. Можете переформулировать? 🤔",
          "Пока не могу дать точный ответ на этот вопрос. Может, спросите что-то другое?",
          "Хм, это выходит за пределы моих текущих знаний. Попробуйте задать вопрос по-другому!",
          "Интересный запрос! К сожалению, я еще не научился отвечать на такие вопросы.",
          "Пока не могу помочь с этим. Но я постоянно учусь! Задайте другой вопрос!"
        ],
        
        // Шутки
        jokes: [
          "Почему программист всегда мокрый? Потому что он постоянно в бассейне с кодом! 😄",
          "Знаете, чем отличается компьютер от сотрудника? Компьютер можно перезагрузить!",
          "Почему ботан не боится темноты? Потому что он и так всегда в тени!",
          "Что сказал один бит другому? Давай держаться вместе!",
          "Почему математики такие плохие садоводы? Потому что они всегда вычитают корни!"
        ],
        
        // Вопросы о создателях
        creators: [
          "Платформа Феникс создана командой энтузиастов для удобного и безопасного обмена игровыми предметами!",
          "Над платформой работает команда из 10+ специалистов: разработчиков, дизайнеров и модераторов!",
          "Феникс - это продукт международной команды разработчиков, увлеченных играми и технологиями!"
        ],
        
        // Вопросы о будущем
        future: [
          "В будущем мы планируем добавить мобильное приложение, новые игры и расширенные функции обмена!",
          "Скоро появятся аукционы, система ставок и интеграция с популярными игровыми платформами!",
          "Мы работаем над мобильным приложением, улучшенной системой рекомендаций и поддержкой новых игр!"
        ]
      },
      
      // Функция для получения ответа
      getResponse: function(message) {
        const lowerMessage = message.toLowerCase();
        
        // Приветствия
        if (lowerMessage.includes('привет') || lowerMessage.includes('здравствуй') || 
            lowerMessage.includes('добрый') || lowerMessage.includes('hi') || 
            lowerMessage.includes('hello') || lowerMessage.includes('хай')) {
          return this.getRandomResponse('greeting');
        }
        
        // Прощания
        if (lowerMessage.includes('пока') || lowerMessage.includes('до свидания') || 
            lowerMessage.includes('прощай') || lowerMessage.includes('bye') || 
            lowerMessage.includes('goodbye') || lowerMessage.includes('удачи')) {
          return this.getRandomResponse('farewell');
        }
        
        // Благодарности
        if (lowerMessage.includes('спасибо') || lowerMessage.includes('благодарю') || 
            lowerMessage.includes('thanks') || lowerMessage.includes('thank you')) {
          return this.getRandomResponse('thanks');
        }
        
        // Вопросы о платформе
        if (lowerMessage.includes('платформа') || lowerMessage.includes('финикс') || 
            lowerMessage.includes('fenix') || lowerMessage.includes('обмен')) {
          return this.getRandomResponse('platform');
        }
        
        // Функционал
        if (lowerMessage.includes('функци') || lowerMessage.includes('возможност') || 
            lowerMessage.includes('умеешь') || lowerMessage.includes('делать')) {
          return this.getRandomResponse('functionality');
        }
        
        // Безопасность
        if (lowerMessage.includes('безопасн') || lowerMessage.includes('защит') || 
            lowerMessage.includes('мошенни') || lowerMessage.includes('надежн')) {
          return this.getRandomResponse('security');
        }
        
        // Поддержка
        if (lowerMessage.includes('поддержк') || lowerMessage.includes('помощь') || 
            lowerMessage.includes('контакт') || lowerMessage.includes('support')) {
          return this.getRandomResponse('support');
        }
        
        // Комиссия
        if (lowerMessage.includes('комисси') || lowerMessage.includes('стоимос') || 
            lowerMessage.includes('плат') || lowerMessage.includes('fee')) {
          return this.getRandomResponse('commission');
        }
        
        // Время обработки
        if (lowerMessage.includes('время') || lowerMessage.includes('скоро') || 
            lowerMessage.includes('быстро') || lowerMessage.includes('обработк')) {
          return this.getRandomResponse('processing');
        }
        
        // Создатели
        if (lowerMessage.includes('создател') || lowerMessage.includes('разработч') || 
            lowerMessage.includes('команда') || lowerMessage.includes('автор')) {
          return this.getRandomResponse('creators');
        }
        
        // Будущее
        if (lowerMessage.includes('будущ') || lowerMessage.includes('план') || 
            lowerMessage.includes('новый') || lowerMessage.includes('обновлен')) {
          return this.getRandomResponse('future');
        }
        
        // Шутки
        if (lowerMessage.includes('шутк') || lowerMessage.includes('смешн') || 
            lowerMessage.includes('юмор') || lowerMessage.includes('анекдот') ||
            lowerMessage.includes('расскажи что-нибудь веселое')) {
          return this.getRandomResponse('jokes');
        }
        
        // Как дела
        if (lowerMessage.includes('как дела') || lowerMessage.includes('как ты') || 
            lowerMessage.includes('how are you') || lowerMessage.includes('how do you do')) {
          return "У меня все отлично! Работаю на полную мощность и готов помогать вам! А у вас как дела? 😊";
        }
        
        // Кто ты
        if (lowerMessage.includes('кто ты') || lowerMessage.includes('что ты') || 
            lowerMessage.includes('who are you') || lowerMessage.includes('what are you')) {
          return "Я - ваш помощник Феникс! Создан, чтобы помогать пользователям на платформе обмена игровыми предметами!";
        }
        
        // Помощь
        if (lowerMessage.includes('помощь') || lowerMessage.includes('help') || 
            lowerMessage.includes('команды') || lowerMessage.includes('что ты умеешь')) {
          return "Я могу помочь с:\n• Информацией о платформе\n• Процессом обмена\n• Безопасностью сделок\n• Поддержкой\n• Шутками 😄\n\nПросто задайте вопрос!";
        }
        
        // Общие вопросы
        if (lowerMessage.includes('?') || lowerMessage.length > 15) {
          return this.getRandomResponse('general');
        }
        
        // Непонятные запросы
        return this.getRandomResponse('unknown');
      },
      
      // Функция для получения случайного ответа из категории
      getRandomResponse: function(category) {
        const responses = this.responses[category];
        return responses[Math.floor(Math.random() * responses.length)];
      }
    };

    // Функция для переключения темы
    function toggleTheme() {
      isLightTheme = !isLightTheme;
      localStorage.setItem('isLightTheme', isLightTheme);
      
      const themeToggle = document.getElementById('themeToggle');
      const body = document.body;
      
      if (isLightTheme) {
        body.classList.add('light-theme');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
      } else {
        body.classList.remove('light-theme');
        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
      }
    }

    // Функция для создания киберпанк сетки
    function createCyberGrid() {
      const grid = document.getElementById('cyberGrid');
      const gridSize = 20;
      
      // Создаем вертикальные линии
      for (let i = 0; i < gridSize; i++) {
        const line = document.createElement('div');
        line.className = 'grid-line vertical';
        line.style.left = `${(i / gridSize) * 100}%`;
        grid.appendChild(line);
      }
      
      // Создаем горизонтальные линии
      for (let i = 0; i < gridSize; i++) {
        const line = document.createElement('div');
        line.className = 'grid-line horizontal';
        line.style.top = `${(i / gridSize) * 100}%`;
        grid.appendChild(line);
      }
      
      // Создаем частицы
      const particleCount = 50;
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'cyber-particle';
        
        const left = Math.random() * 100;
        const animationDuration = Math.random() * 10 + 5;
        const animationDelay = Math.random() * 5;
        
        particle.style.left = `${left}%`;
        particle.style.animationDuration = `${animationDuration}s`;
        particle.style.animationDelay = `${animationDelay}s`;
        
        grid.appendChild(particle);
      }
    }

    // Функция для создания частиц
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        // Случайные начальные позиции
        const left = Math.random() * 100;
        const size = Math.random() * 3 + 1;
        const opacity = Math.random() * 0.5 + 0.2;
        const animationDuration = Math.random() * 20 + 10;
        const animationDelay = Math.random() * 5;
        
        particle.style.left = `${left}%`;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.opacity = opacity;
        particle.style.animationDuration = `${animationDuration}s`;
        particle.style.animationDelay = `${animationDelay}s`;
        
        particlesContainer.appendChild(particle);
      }
    }

    // Функция для показа хакерского текста
    function showHackingText() {
      const hackingText = document.getElementById('hackingText');
      const texts = [
        "ИНИЦИАЛИЗАЦИЯ СИСТЕМЫ...",
        "ЗАГРУЗКА БАЗЫ ДАННЫХ...",
        "ПОДКЛЮЧЕНИЕ К СЕТИ...",
        "ПРОВЕРКА БЕЗОПАСНОСТИ...",
        "АКТИВАЦИЯ ПЛАТФОРМЫ...",
        "ГОТОВО! ДОБРО ПОЖАЛОВАТЬ!"
      ];
      
      let currentIndex = 0;
      
      function showNextText() {
        if (currentIndex < texts.length) {
          const textElement = document.createElement('div');
          textElement.className = 'hacking-line';
          textElement.textContent = texts[currentIndex];
          hackingText.appendChild(textElement);
          
          // Удаляем старые строки, чтобы не переполнять контейнер
          if (hackingText.children.length > 3) {
            hackingText.removeChild(hackingText.children[0]);
          }
          
          currentIndex++;
          setTimeout(showNextText, 800);
        }
      }
      
      showNextText();
    }

    // Функция для скрытия заставки
    function hideLoader() {
      const loader = document.getElementById('cyberpunkLoader');
      setTimeout(() => {
        loader.style.opacity = '0';
        setTimeout(() => {
          loader.style.display = 'none';
        }, 1000);
      }, 3000);
    }

    // Функция перехода на главной странице
    function goToMainPage() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Функции для работы с модальными окнами
    function showLogin() {
      document.getElementById('loginModal').style.display = 'block';
    }

    function showRegister() {
      document.getElementById('registerModal').style.display = 'block';
    }

    // Функции для переключения между формами входа и регистрации
    function switchToLogin() {
      closeModal('registerModal');
      showLogin();
    }

    function switchToRegister() {
      closeModal('loginModal');
      showRegister();
    }

    // Функция для показа профиля
    function showProfile() {
      if (!currentUser) return;
      
      const profileModal = document.getElementById('profileModal');
      const modalContent = profileModal.querySelector('.modal-content');
      modalContent.classList.add('extra-large');
      
      const profileContent = document.getElementById('profileContent');
      const registrationDate = new Date(currentUser.registrationDate || new Date()).toLocaleDateString('ru-RU');
      
      let profileHTML = `
        <div class="avatar-upload">
          <div class="avatar-preview">
            <img id="profileAvatar" src="${currentUser.avatar || 'https://img.icons8.com/?size=100&id=109512&format=png&color=000000'}" alt="Аватар" />
          </div>
          <button class="avatar-upload-btn" onclick="uploadAvatar()">
            <i class="fas fa-upload"></i> Загрузить аватар
          </button>
        </div>
        <div class="profile-info">
          <div class="profile-field">
            <span class="profile-label">Имя:</span>
            <span class="profile-value">${currentUser.name}</span>
          </div>
          <div class="profile-field">
            <span class="profile-label">Email:</span>
            <span class="profile-value">${currentUser.email}</span>
          </div>
          <div class="profile-field">
            <span class="profile-label">Роль:</span>
            <span class="profile-value">${currentUser.role === 'admin' ? 'Администратор' : 'Пользователь'}</span>
          </div>
          <div class="profile-field">
            <span class="profile-label">Баланс:</span>
            <span class="profile-value">${currentUser.balance || 0} ₽</span>
          </div>
          <div class="profile-field">
            <span class="profile-label">Дата регистрации:</span>
            <span class="profile-value">${registrationDate}</span>
          </div>
          <div class="profile-field">
            <span class="profile-label">ID пользователя:</span>
            <span class="profile-value">${currentUser.id}</span>
          </div>
        </div>
      `;
      
      // Добавляем раздел с выпавшими предметами
      if (currentUser.dropItems && currentUser.dropItems.length > 0) {
        profileHTML += `
          <div class="profile-info">
            <h3 style="color: var(--primary); margin-bottom: 15px;">Мои выпавшие предметы</h3>
            <div class="drop-items-list">
              ${currentUser.dropItems.map(item => `
                <div class="drop-item">
                  <img src="${item.image}" alt="${item.name}" />
                  <div class="drop-item-name">${item.name}</div>
                  <div class="drop-item-price">${item.price} ₽</div>
                  <button class="claim-btn" onclick="claimItem(${item.id})">Забрать</button>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      }
      
      // Добавляем историю обменов
      profileHTML += `
        <div class="exchange-history">
          <h3 style="color: var(--primary); text-align: center; margin-bottom: 15px;">История обменов</h3>
          <div id="profileExchangeHistory">
            ${loadExchangeHistoryForProfile()}
          </div>
        </div>
      `;
      
      // Для админа добавляем историю входов пользователей
      if (currentUser.role === 'admin') {
        profileHTML += `
          <div class="users-history">
            <h3 style="color: var(--primary); text-align: center; margin-bottom: 15px;">История входов пользователей</h3>
            <div id="profileUsersHistory">
              ${loadUsersHistoryForProfile()}
            </div>
          </div>
        `;
      }
      
      // Для обычных пользователей добавляем опасную зону
      if (currentUser.role !== 'admin') {
        profileHTML += `
          <div class="danger-zone">
            <h3>Опасная зона</h3>
            <button class="delete-btn" onclick="deleteAccount()">
              <i class="fas fa-trash"></i> Удалить аккаунт
            </button>
          </div>
        `;
      }
      
      profileContent.innerHTML = profileHTML;
      profileModal.style.display = 'block';
    }

    // Функция для показа баланса
    function showBalanceModal() {
      const balanceModal = document.getElementById('balanceModal');
      const modalContent = balanceModal.querySelector('.modal-content');
      modalContent.classList.add('large');
      
      balanceModal.style.display = 'block';
    }

    // Функция для показа колеса фортуны
    function showFortuneModal() {
      const fortuneModal = document.getElementById('fortuneModal');
      const modalContent = fortuneModal.querySelector('.modal-content');
      modalContent.classList.add('large');
      
      fortuneModal.style.display = 'block';
      initWheel('fortuneWheel');
      updateFortuneTimer('fortuneTimer');
    }

    // Функция для показа новостей ВК
    function showVKNews() {
      const vkNewsModal = document.getElementById('vkNewsModal');
      const modalContent = vkNewsModal.querySelector('.modal-content');
      modalContent.classList.add('extra-large');
      
      vkNewsModal.style.display = 'block';
      loadVKPostsOnMainPage();
    }

    // Функция закрытия модального окна
    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      const modalContent = modal.querySelector('.modal-content');
      
      // Удаляем дополнительные классы
      modalContent.classList.remove('large', 'extra-large');
      
      modal.style.display = 'none';
    }

    // Функция для переключения между вкладками пополнения и вывода
    function switchBalanceTab(tab) {
      // Убираем активный класс со всех вкладок
      document.querySelectorAll('.balance-tab').forEach(t => {
        t.classList.remove('active');
      });
      
      // Добавляем активный класс выбранной вкладке
      document.querySelector(`.balance-tab[onclick="switchBalanceTab('${tab}')"]`).classList.add('active');
      
      // Скрываем все формы
      document.querySelectorAll('.balance-form').forEach(form => {
        form.classList.remove('active');
      });
      
      // Показываем выбранную форму
      document.getElementById(`${tab}Form`).classList.add('active');
    }

    // Функция для загрузки аватара
    function uploadAvatar() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*';
      
      input.onchange = function(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            const avatarData = e.target.result;
            
            // Обновляем аватар в профиле
            document.getElementById('profileAvatar').src = avatarData;
            
            // Обновляем аватар в хедере
            document.getElementById('headerAvatar').src = avatarData;
            
            // Сохраняем аватар в данных пользователя
            if (currentUser) {
              const users = JSON.parse(localStorage.getItem('users') || '[]');
              const userIndex = users.findIndex(u => u.id === currentUser.id);
              
              if (userIndex !== -1) {
                users[userIndex].avatar = avatarData;
                localStorage.setItem('users', JSON.stringify(users));
                
                currentUser.avatar = avatarData;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
              }
            }
            
            alert('Аватар успешно обновлен!');
          };
          
          reader.readAsDataURL(file);
        }
      };
      
      input.click();
    }

    // Функция для забора выпавшего предмета
    function claimItem(itemId) {
      if (!currentUser) return;
      
      const itemIndex = currentUser.dropItems.findIndex(item => item.id === itemId);
      if (itemIndex === -1) return;
      
      const item = currentUser.dropItems[itemIndex];
      
      // Удаляем из выпавших предметов
      currentUser.dropItems.splice(itemIndex, 1);
      
      // Добавляем в инвентарь
      if (!currentUser.inventory) {
        currentUser.inventory = [];
      }
      currentUser.inventory.push(item);
      
      // Обновляем пользователя в localStorage
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      
      if (userIndex !== -1) {
        users[userIndex].dropItems = currentUser.dropItems;
        users[userIndex].inventory = currentUser.inventory;
        localStorage.setItem('users', JSON.stringify(users));
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
      }
      
      // Обновляем профиль
      showProfile();
      alert(`Предмет "${item.name}" добавлен в ваш инвентарь!`);
    }

    // Функция удаления аккаунта
    function deleteAccount() {
      if (!currentUser || currentUser.role === 'admin') return;
      
      if (confirm('Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить!')) {
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const updatedUsers = users.filter(user => user.id !== currentUser.id);
        
        localStorage.setItem('users', JSON.stringify(updatedUsers));
        localStorage.removeItem('currentUser');
        
        currentUser = null;
        updateUI();
        closeModal('profileModal');
        
        alert('Аккаунт успешно удален!');
      }
    }

    // Функция входа - УЛУЧШЕННАЯ ВЕРСИЯ
    function login(email, password) {
      // Обновляем список пользователей на случай изменений
      users = JSON.parse(localStorage.getItem('users') || '[]');
      
      // Проверяем учетные данные администратора по умолчанию
      if (email === 'admin@ya.ru' && password === 'admin123') {
        console.log('Попытка входа как администратор...');
        
        // Ищем администратора в базе
        let adminUser = users.find(u => u.email === 'admin@ya.ru');
        
        if (!adminUser) {
          console.log('Администратор не найден, создаем...');
          // Создаем администратора, если его нет
          adminUser = {
            id: 1,
            name: 'Администратор',
            email: 'admin@ya.ru',
            password: 'admin123',
            role: 'admin',
            avatar: 'https://img.icons8.com/?size=100&id=109512&format=png&color=000000',
            registrationDate: new Date().toISOString(),
            balance: 10000,
            inventory: [],
            dropItems: []
          };
          users.push(adminUser);
          localStorage.setItem('users', JSON.stringify(users));
        }
        
        currentUser = adminUser;
        localStorage.setItem('currentUser', JSON.stringify(adminUser));
        
        // Добавляем запись в историю входов
        usersHistory.push({
          userId: adminUser.id,
          userName: adminUser.name,
          loginTime: new Date().toISOString(),
          role: adminUser.role
        });
        localStorage.setItem('usersHistory', JSON.stringify(usersHistory));
        
        updateUI();
        closeModal('loginModal');
        console.log('Успешный вход как администратор!');
        return true;
      }
      
      // Обычная проверка пользователей
      const user = users.find(u => u.email === email && u.password === password);
      
      if (user) {
        currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(user));
        
        // Добавляем запись в историю входов
        usersHistory.push({
          userId: user.id,
          userName: user.name,
          loginTime: new Date().toISOString(),
          role: user.role
        });
        localStorage.setItem('usersHistory', JSON.stringify(usersHistory));
        
        updateUI();
        closeModal('loginModal');
        return true;
      }
      
      console.log('Неверные учетные данные. Доступные пользователи:', users);
      return false;
    }

    // Функция регистрации - УЛУЧШЕННАЯ ВЕРСИЯ
    function register(name, email, password) {
      // Обновляем список пользователей
      users = JSON.parse(localStorage.getItem('users') || '[]');
      
      // Проверка на существующего пользователя
      if (users.find(u => u.email === email)) {
        alert('Пользователь с таким email уже существует!');
        return false;
      }

      const newUser = {
        id: Date.now(),
        name: name,
        email: email,
        password: password,
        role: 'user',
        avatar: 'https://img.icons8.com/?size=100&id=109512&format=png&color=000000',
        registrationDate: new Date().toISOString(),
        balance: 0,
        inventory: [],
        dropItems: []
      };

      users.push(newUser);
      localStorage.setItem('users', JSON.stringify(users));
      
      currentUser = newUser;
      localStorage.setItem('currentUser', JSON.stringify(newUser));
      updateUI();
      closeModal('registerModal');
      
      alert('Регистрация успешна! Добро пожаловать!');
      return true;
    }

    // Функция выхода
    function logout() {
      currentUser = null;
      localStorage.removeItem('currentUser');
      selectedOfferItems = [];
      selectedWantItems = [];
      updateUI();
      updateSelectedItemsDisplay();
    }

    // Функция пополнения баланса
    function addBalance(amount) {
      if (!currentUser) return false;
      
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      
      if (userIndex !== -1) {
        users[userIndex].balance = (users[userIndex].balance || 0) + amount;
        localStorage.setItem('users', JSON.stringify(users));
        
        currentUser.balance = users[userIndex].balance;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        updateUI();
        return true;
      }
      return false;
    }

    // Функция вывода средств
    function withdrawBalance(amount, bank) {
      if (!currentUser) return false;
      
      if (currentUser.balance < amount) {
        alert('Недостаточно средств на балансе!');
        return false;
      }
      
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const userIndex = users.findIndex(u => u.id === currentUser.id);
      
      if (userIndex !== -1) {
        users[userIndex].balance = (users[userIndex].balance || 0) - amount;
        localStorage.setItem('users', JSON.stringify(users));
        
        currentUser.balance = users[userIndex].balance;
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        // Добавляем запись в историю выводов
        const withdrawHistory = JSON.parse(localStorage.getItem('withdrawHistory') || '[]');
        withdrawHistory.push({
          userId: currentUser.id,
          userName: currentUser.name,
          amount: amount,
          bank: bank,
          date: new Date().toISOString()
        });
        localStorage.setItem('withdrawHistory', JSON.stringify(withdrawHistory));
        
        updateUI();
        return true;
      }
      return false;
    }

    // Обновление интерфейса в зависимости от роли пользователя
    function updateUI() {
      const userInfo = document.getElementById('userInfo');
      const authButtons = document.getElementById('authButtons');
      const adminBadge = document.getElementById('adminBadge');
      const userName = document.getElementById('userName');
      const userBalance = document.getElementById('userBalance');
      const headerAvatar = document.getElementById('headerAvatar');
      const mainNav = document.getElementById('mainNav');
      const selectedItemsSection = document.getElementById('selectedItemsSection');
      const exchangeButton = document.getElementById('exchangeButton');
      const mineSection = document.getElementById('mine');
      const bannerSection = document.getElementById('bannerSection');
      const scrollingSection = document.getElementById('scrollingSection');
      const fortuneSection = document.getElementById('fortuneSection');
      const vkManagementBtn = document.getElementById('vkManagementBtn');

      if (currentUser) {
        // Пользователь вошел
        userInfo.style.display = 'flex';
        authButtons.style.display = 'none';
        userName.textContent = currentUser.name;
        userBalance.textContent = `${currentUser.balance || 0} ₽`;
        headerAvatar.src = currentUser.avatar || 'https://img.icons8.com/?size=100&id=109512&format=png&color=000000';
        selectedItemsSection.style.display = 'block';
        mineSection.style.display = 'block';
        bannerSection.style.display = 'none';
        scrollingSection.style.display = 'block';
        fortuneSection.style.display = 'none';
        
        // Показываем кнопку управления VK для админа
        if (currentUser.role === 'admin') {
          vkManagementBtn.style.display = 'flex';
        } else {
          vkManagementBtn.style.display = 'none';
        }
        
        // Останавливаем автоматическую смену баннеров
        clearInterval(bannerInterval);
        
        // Показываем бейдж админа если пользователь админ
        if (currentUser.role === 'admin') {
          adminBadge.style.display = 'inline';
        } else {
          adminBadge.style.display = 'none';
        }

        // Включаем кнопку обмена для вошедших пользователей
        exchangeButton.disabled = false;

        // Обновляем навигацию
        let navHTML = `
          <a href="#mine">Мои предметы</a>
          <a href="#exchange">Предметы для обмена</a>
          <a href="#" onclick="showSiteNewsModal()">Новости сайта</a>
          <a href="#contacts">Контакты</a>
        `;

        mainNav.innerHTML = navHTML;

      } else {
        // Пользователь не вошел
        userInfo.style.display = 'none';
        authButtons.style.display = 'flex';
        selectedItemsSection.style.display = 'none';
        mineSection.style.display = 'none';
        bannerSection.style.display = 'flex';
        scrollingSection.style.display = 'none';
        fortuneSection.style.display = 'none';
        vkManagementBtn.style.display = 'none';
        
        // Запускаем автоматическую смену баннеров
        startBannerRotation();
        
        // Отключаем кнопку обмена для гостей
        exchangeButton.disabled = true;
        
        // Базовая навигация для гостя
        mainNav.innerHTML = `
          <a href="#exchange">Предметы для обмена</a>
          <a href="#" onclick="showSiteNewsModal()">Новости сайта</a>
          <a href="#" onclick="showVKNews()">Новости ВК</a>
          <a href="#contacts">Контакты</a>
        `;
      }
    }

    // Функции для работы с баннером
    function changeBannerSlide(direction) {
      const slides = document.querySelectorAll('.banner-slide');
      const dots = document.querySelectorAll('.banner-dot');
      
      slides[currentBannerSlide].classList.remove('active');
      dots[currentBannerSlide].classList.remove('active');
      
      currentBannerSlide = (currentBannerSlide + direction + slides.length) % slides.length;
      
      slides[currentBannerSlide].classList.add('active');
      dots[currentBannerSlide].classList.add('active');
    }
    
    function setBannerSlide(index) {
      const slides = document.querySelectorAll('.banner-slide');
      const dots = document.querySelectorAll('.banner-dot');
      
      slides[currentBannerSlide].classList.remove('active');
      dots[currentBannerSlide].classList.remove('active');
      
      currentBannerSlide = index;
      
      slides[currentBannerSlide].classList.add('active');
      dots[currentBannerSlide].classList.add('active');
    }
    
    function startBannerRotation() {
      // Останавливаем предыдущий интервал, если он был
      clearInterval(bannerInterval);
      
      // Запускаем автоматическую смену слайдов каждые 5 секунд
      bannerInterval = setInterval(() => {
        changeBannerSlide(1);
      }, 5000);
    }

    // Загрузка истории пользователей для профиля админа
    function loadUsersHistoryForProfile() {
      const recentHistory = usersHistory.slice(-10).reverse();
      
      if (recentHistory.length === 0) {
        return '<p style="text-align: center; color: #888;">История входов пуста</p>';
      }
      
      return recentHistory.map(entry => `
        <div class="user-history-item">
          <div>
            <strong>${entry.userName}</strong> (${entry.role})
            <div style="font-size: 0.8rem; color: #888;">
              ${new Date(entry.loginTime).toLocaleString('ru-RU')}
            </div>
          </div>
          <div style="color: var(--primary);">
            ID: ${entry.userId}
          </div>
        </div>
      `).join('');
    }

    // Загрузка истории обменов для профиля
    function loadExchangeHistoryForProfile() {
      const userHistory = exchangeHistory.filter(entry => entry.userId === currentUser.id).slice(-10).reverse();
      
      if (userHistory.length === 0) {
        return '<p style="text-align: center; color: #888;">История обменов пуста</p>';
      }
      
      return userHistory.map(entry => `
        <div class="exchange-history-item">
          <div class="exchange-details">
            <div class="exchange-items">
              <span>${entry.offerItems.length} предметов</span>
              <span class="exchange-arrow-small"><i class="fas fa-exchange-alt"></i></span>
              <span>${entry.wantItems.length} предметов</span>
            </div>
            <div class="exchange-date">
              ${new Date(entry.date).toLocaleString('ru-RU')}
            </div>
          </div>
          <div class="exchange-status status-${entry.status}">
            ${entry.status === 'completed' ? 'Завершен' : entry.status === 'pending' ? 'В обработке' : 'Ошибка'}
          </div>
        </div>
      `).join('');
    }

    // Функция для выбора предмета
    function selectItem(item, type) {
      if (!currentUser) {
        alert('Для выбора предметов необходимо войти в систему!');
        showLogin();
        return;
      }

      const selectedArray = type === 'offer' ? selectedOfferItems : selectedWantItems;
      const existingIndex = selectedArray.findIndex(selected => selected.id === item.id);
      
      if (existingIndex !== -1) {
        // Удаляем предмет если он уже выбран
        selectedArray.splice(existingIndex, 1);
      } else {
        // Добавляем предмет
        selectedArray.push(item);
      }
      
      updateSelectedItemsDisplay();
    }

    // Функция удаления выбранного предмета
    function removeSelectedItem(itemId, type) {
      const selectedArray = type === 'offer' ? selectedOfferItems : selectedWantItems;
      const index = selectedArray.findIndex(item => item.id === itemId);
      
      if (index !== -1) {
        selectedArray.splice(index, 1);
        updateSelectedItemsDisplay();
      }
    }

    // Обновление отображения выбранных предметов
    function updateSelectedItemsDisplay() {
      const selectedOfferContainer = document.getElementById('selectedOfferItems');
      const selectedWantContainer = document.getElementById('selectedWantItems');
      
      // Обновляем счетчики и суммы
      const offerCount = selectedOfferItems.length;
      const wantCount = selectedWantItems.length;
      const offerTotal = selectedOfferItems.reduce((sum, item) => sum + item.price, 0);
      const wantTotal = selectedWantItems.reduce((sum, item) => sum + item.price, 0);
      const difference = wantTotal - offerTotal;
      
      document.getElementById('offerCount').textContent = offerCount;
      document.getElementById('wantCount').textContent = wantCount;
      document.getElementById('offerTotal').textContent = `${offerTotal} ₽`;
      document.getElementById('wantTotal').textContent = `${wantTotal} ₽`;
      
      // Обновляем разницу
      const differenceElement = document.getElementById('exchangeDifference');
      if (difference > 0) {
        differenceElement.textContent = `Доплата: ${difference} ₽`;
        differenceElement.style.color = '#ff6b6b';
      } else if (difference < 0) {
        differenceElement.textContent = `Возврат: ${Math.abs(difference)} ₽`;
        differenceElement.style.color = '#4caf50';
      } else {
        differenceElement.textContent = 'Разница: 0 ₽';
        differenceElement.style.color = '#ffd700';
      }
      
      // Обновляем отображение выбранных предметов
      selectedOfferContainer.innerHTML = selectedOfferItems.map(item => `
        <div class="selected-item">
          <button class="remove-item" onclick="removeSelectedItem(${item.id}, 'offer')">×</button>
          <img src="${item.image}" alt="${item.name}" />
          <div class="item-name">${item.name}</div>
          <div class="item-price">${item.price} ₽</div>
        </div>
      `).join('');
      
      selectedWantContainer.innerHTML = selectedWantItems.map(item => `
        <div class="selected-item">
          <button class="remove-item" onclick="removeSelectedItem(${item.id}, 'want')">×</button>
          <img src="${item.image}" alt="${item.name}" />
          <div class="item-name">${item.name}</div>
          <div class="item-price">${item.price} ₽</div>
        </div>
      `).join('');
      
      // Обновляем выделение в списках предметов
      updateItemsSelection();
    }

    // Обновление выделения предметов в списках
    function updateItemsSelection() {
      // Обновляем выделение в "Мои предметы"
      document.querySelectorAll('#myItemsList .item-select').forEach(element => {
        const itemId = parseInt(element.dataset.id);
        const isSelected = selectedOfferItems.some(item => item.id === itemId);
        element.classList.toggle('selected', isSelected);
      });
      
      // Обновляем выделение в "Предметы для обмена"
      document.querySelectorAll('#exchangeItemsList .item-select').forEach(element => {
        const itemId = parseInt(element.dataset.id);
        const isSelected = selectedWantItems.some(item => item.id === itemId);
        element.classList.toggle('selected', isSelected);
      });
    }

    // Сохранение фильтров
    function saveFilters() {
      const filters = {
        minPrice: document.getElementById('minPrice').value,
        maxPrice: document.getElementById('maxPrice').value,
        type: document.getElementById('typeFilter').value,
        quality: document.getElementById('qualityFilter').value,
        rarity: document.getElementById('rarityFilter').value
      };
      
      localStorage.setItem('itemFilters', JSON.stringify(filters));
      alert('Фильтры сохранены!');
      applyFilters();
      filterItems();
    }

    // Применение фильтров
    function applyFilters() {
      const savedFilters = JSON.parse(localStorage.getItem('itemFilters') || '{}');
      
      if (savedFilters.minPrice) document.getElementById('minPrice').value = savedFilters.minPrice;
      if (savedFilters.maxPrice) document.getElementById('maxPrice').value = savedFilters.maxPrice;
      if (savedFilters.type) document.getElementById('typeFilter').value = savedFilters.type;
      if (savedFilters.quality) document.getElementById('qualityFilter').value = savedFilters.quality;
      if (savedFilters.rarity) document.getElementById('rarityFilter').value = savedFilters.rarity;
    }

    // Фильтрация предметов
    function filterItems() {
      const savedFilters = JSON.parse(localStorage.getItem('itemFilters') || '{}');
      const minPrice = parseFloat(savedFilters.minPrice) || 0;
      const maxPrice = parseFloat(savedFilters.maxPrice) || Infinity;
      const typeFilter = savedFilters.type || '';
      const qualityFilter = savedFilters.quality || '';
      const rarityFilter = savedFilters.rarity || '';
      
      // Фильтруем предметы в "Мои предметы"
      document.querySelectorAll('#myItemsList .item-select').forEach(element => {
        const itemId = parseInt(element.dataset.id);
        const item = items.find(i => i.id === itemId);
        
        if (item) {
          const matchesPrice = item.price >= minPrice && item.price <= maxPrice;
          const matchesType = !typeFilter || item.type === typeFilter;
          const matchesQuality = !qualityFilter || item.quality === qualityFilter;
          const matchesRarity = !rarityFilter || item.rarity === rarityFilter;
          
          element.style.display = matchesPrice && matchesType && matchesQuality && matchesRarity ? 'block' : 'none';
        }
      });
      
      // Фильтруем предметы в "Предметы для обмена"
      document.querySelectorAll('#exchangeItemsList .item-select').forEach(element => {
        const itemId = parseInt(element.dataset.id);
        const item = items.find(i => i.id === itemId);
        
        if (item) {
          const matchesPrice = item.price >= minPrice && item.price <= maxPrice;
          const matchesType = !typeFilter || item.type === typeFilter;
          const matchesQuality = !qualityFilter || item.quality === qualityFilter;
          const matchesRarity = !rarityFilter || item.rarity === rarityFilter;
          
          element.style.display = matchesPrice && matchesType && matchesQuality && matchesRarity ? 'block' : 'none';
        }
      });
    }

    // Функция для показа информации о предмете
    function showItemInfo(item) {
      const itemInfoModal = document.getElementById('itemInfoModal');
      const itemInfoContent = document.getElementById('itemInfoContent');
      
      const typeNames = {
        'weapon': 'Оружие',
        'armor': 'Броня',
        'potion': 'Зелье',
        'accessory': 'Аксессуар'
      };
      
      const qualityNames = {
        'common': 'Обычное',
        'uncommon': 'Необычное',
        'rare': 'Редкое',
        'epic': 'Эпическое',
        'legendary': 'Легендарное'
      };
      
      const rarityNames = {
        'common': 'Частый',
        'uncommon': 'Нечастый',
        'rare': 'Редкий',
        'mythical': 'Мифический',
        'immortal': 'Бессмертный'
      };
      
      itemInfoContent.innerHTML = `
        <div class="item-details">
          <img src="${item.image}" alt="${item.name}" class="item-image-large" />
          <div class="item-detail-row">
            <span class="item-detail-label">Название:</span>
            <span class="item-detail-value">${item.name}</span>
          </div>
          <div class="item-detail-row">
            <span class="item-detail-label">Цена:</span>
            <span class="item-detail-value">${item.price} ₽</span>
          </div>
          <div class="item-detail-row">
            <span class="item-detail-label">Тип:</span>
            <span class="item-detail-value">${typeNames[item.type] || item.type}</span>
          </div>
          <div class="item-detail-row">
            <span class="item-detail-label">Качество:</span>
            <span class="item-detail-value">${qualityNames[item.quality] || item.quality}</span>
          </div>
          <div class="item-detail-row">
            <span class="item-detail-label">Редкость:</span>
            <span class="item-detail-value">${rarityNames[item.rarity] || item.rarity}</span>
          </div>
        </div>
      `;
      
      itemInfoModal.style.display = 'block';
    }

    // Функция для переключения чата ИИ-ассистента
    function toggleAIChat() {
      const chatContainer = document.getElementById('aiChatContainer');
      chatOpen = !chatOpen;
      
      if (chatOpen) {
        chatContainer.classList.add('active');
      } else {
        chatContainer.classList.remove('active');
      }
    }

    // Функция для переключения чат-бота
    function toggleChatBot() {
      const botContainer = document.getElementById('chatBotContainer');
      botOpen = !botOpen;
      
      if (botOpen) {
        botContainer.classList.add('active');
      } else {
        botContainer.classList.remove('active');
      }
    }

    // Функция для отправки сообщения в ИИ-ассистент
    function sendMessage() {
      const input = document.getElementById('aiChatInput');
      const message = input.value.trim();
      
      if (message === '') return;
      
      addMessage(message, 'user');
      input.value = '';
      
      // Используем локального бота для ответа
      setTimeout(() => {
        const botResponse = localBot.getResponse(message);
        addMessage(botResponse, 'ai');
      }, 1000);
    }

    // Функция для отправки сообщения в чат-бот
    function sendBotMessage() {
      const input = document.getElementById('chatBotInput');
      const message = input.value.trim();
      
      if (message === '') return;
      
      addBotMessage(message, 'user');
      input.value = '';
      
      // Используем локального бота для ответа
      setTimeout(() => {
        const botResponse = localBot.getResponse(message);
        addBotMessage(botResponse, 'ai');
      }, 1000);
    }

    // Функция для быстрых вопросов в ИИ-ассистенте
    function askQuickQuestion(element) {
      const question = element.textContent;
      addMessage(question, 'user');
      
      // Используем локального бота для ответа
      setTimeout(() => {
        const botResponse = localBot.getResponse(question);
        addMessage(botResponse, 'ai');
      }, 1000);
    }

    // Функция для быстрых вопросов в чат-боте
    function askBotQuickQuestion(element) {
      const question = element.textContent;
      addBotMessage(question, 'user');
      
      // Используем локального бота для ответа
      setTimeout(() => {
        const botResponse = localBot.getResponse(question);
        addBotMessage(botResponse, 'ai');
      }, 1000);
    }

    // Функция добавления сообщения в ИИ-ассистент
    function addMessage(text, sender) {
      const messagesContainer = document.getElementById('aiChatMessages');
      const messageElement = document.createElement('div');
      messageElement.className = `message ${sender}-message`;
      messageElement.textContent = text;
      
      messagesContainer.appendChild(messageElement);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    // Функция добавления сообщения в чат-бот
    function addBotMessage(text, sender) {
      const messagesContainer = document.getElementById('chatBotMessages');
      const messageElement = document.createElement('div');
      messageElement.className = `bot-message bot-${sender}-message`;
      messageElement.textContent = text;
      
      messagesContainer.appendChild(messageElement);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    // Function to load and display VK posts on main page
    function loadVKPostsOnMainPage() {
        const postsList = document.getElementById('vkPostsList');
        
        try {
            const savedPosts = JSON.parse(localStorage.getItem('vkPosts') || '[]');
            
            if (savedPosts.length === 0) {
                postsList.innerHTML = `
                    <div style="text-align: center; padding: 20px; color: #888; width: 100%;">
                        <i class="fas fa-newspaper" style="font-size: 2rem; margin-bottom: 10px;"></i>
                        <p>Пока нет новостей. Будьте первым, кто поделится!</p>
                        <a href="vk.html" style="color: var(--primary); text-decoration: none; font-weight: 600;">
                            
                        </a>
                    </div>
                `;
                return;
            }
            
            postsList.innerHTML = '';
            
            savedPosts.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'vk-post-card';
                
                const date = new Date(post.timestamp).toLocaleString('ru-RU');
                
                let imageHTML = '';
                if (post.image) {
                    imageHTML = `
                        <img src="${post.image}" 
                             class="vk-post-image"
                             alt="Изображение поста" 
                             onerror="this.style.display='none'">
                    `;
                }

                let postText = post.text || '';
                if (postText.length > 150) {
                    postText = postText.substring(0, 150) + '...';
                }
                
                postElement.innerHTML = `
                    <div class="vk-post-header">
                        <div style="color: var(--primary); font-weight: 600;">
                            <i class="fab fa-vk"></i> Новость
                        </div>
                        <div class="vk-post-date">
                            <i class="far fa-clock"></i> ${date}
                        </div>
                    </div>
                    <div class="vk-post-text">${postText}</div>
                    ${imageHTML}
                    <div class="vk-post-stats">
                        <span><i class="fas fa-heart"></i> ${post.likes || 0}</span>
                        <span><i class="fas fa-comment"></i> ${post.comments || 0}</span>
                        <span><i class="fas fa-eye"></i> ${post.views || 0}</span>
                    </div>
                `;
                
                postsList.appendChild(postElement);
            });
            
        } catch (error) {
            console.error('Error loading VK posts on main page:', error);
            postsList.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #f44336; width: 100%;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>Ошибка загрузки новостей</p>
                </div>
            `;
        }
    }

    // Функция для создания бесконечной прокрутки
    function initInfiniteScroll() {
        const scrollingList = document.getElementById('scrollingList');
        const items = [
            {
                id: 1,
                name: "Меч Легенды",
                image: "https://avatars.mds.yandex.net/i?id=a88b84155a670aee41eb90fb30cb6ec0a4c71d8d-12923554-images-thumbs&n=13",
                price: 2500,
                type: "weapon",
                quality: "legendary",
                rarity: "immortal"
            },
            {
                id: 2,
                name: "Щит Щитовой",
                image: "https://avatars.mds.yandex.net/i?id=779e43be547a33f1413b71701d623dc7_l-4779391-images-thumbs&n=13",
                price: 1200,
                type: "armor",
                quality: "epic",
                rarity: "mythical"
            },
            {
                id: 3,
                name: "Зелье Лечения",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/tango.png",
                price: 50,
                type: "potion",
                quality: "common",
                rarity: "common"
            },
            {
                id: 4,
                name: "Кольцо Могущества",
                image: "https://avatars.yandex.net/get-music-content/2427101/93572bab.a.8094099-3/m1000x1000",
                price: 800,
                type: "accessory",
                quality: "rare",
                rarity: "rare"
            },
            {
                id: 5,
                name: "Амулет Огня",
                image: "https://avatars.dzeninfra.ru/get-zen_doc/1687249/pub_5fdf65e53713a37b868f1f06_5fdf6bf8c80827600fc11220/scale_1200",
                price: 1500,
                type: "accessory",
                quality: "epic",
                rarity: "mythical"
            },
            {
                id: 6,
                name: "Сапоги Скорости",
                image: "https://images.steamusercontent.com/ugc/2015953485211818058/F346B37985E99B8154887E7E71D5F1E1C550D483/?imw=5000&imh=5000&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false",
                price: 600,
                type: "armor",
                quality: "uncommon",
                rarity: "uncommon"
            },
            {
                id: 7,
                name: "Клинок Раздора",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/blade_of_alacrity.png",
                price: 450,
                type: "weapon",
                quality: "rare",
                rarity: "rare"
            },
            {
                id: 8,
                name: "Посох Чародея",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/staff_of_wizardry.png",
                price: 700,
                type: "weapon",
                quality: "epic",
                rarity: "mythical"
            },
            {
                id: 9,
                name: "Кольцо Регенерации",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/ring_of_regen.png",
                price: 300,
                type: "accessory",
                quality: "uncommon",
                rarity: "uncommon"
            },
            {
                id: 10,
                name: "Перчатки Ловкости",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/gloves_of_haste.png",
                price: 400,
                type: "armor",
                quality: "common",
                rarity: "common"
            },
            {
                id: 11,
                name: "Мантия Разума",
                image: "https://cdnb.artstation.com/p/assets/images/images/079/588/287/large/wassup-homie-glimmer-cape.jpg?1725312219",
                price: 350,
                type: "armor",
                quality: "common",
                rarity: "common"
            },
            {
                id: 12,
                name: "Цепь Железной Воли",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/chainmail.png",
                price: 550,
                type: "armor",
                quality: "uncommon",
                rarity: "uncommon"
            },
            {
                id: 13,
                name: "Курительная Трубка",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/smoke_of_deceit.png",
                price: 100,
                type: "accessory",
                quality: "common",
                rarity: "common"
            },
            {
                id: 14,
                name: "Пыльное Кольцо",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/ring_of_basilius.png",
                price: 250,
                type: "accessory",
                quality: "uncommon",
                rarity: "uncommon"
            },
            {
                id: 15,
                name: "Слеза Богини",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/aether_lens.png",
                price: 1200,
                type: "accessory",
                quality: "epic",
                rarity: "mythical"
            },
            {
                id: 16,
                name: "Сфера Этериала",
                image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/ethereal_blade.png",
                price: 2800,
                type: "weapon",
                quality: "legendary",
                rarity: "immortal"
            }
        ];

        // Создаем элементы для прокрутки
        function createScrollingItem(item) {
            const div = document.createElement("div");
            div.className = "scrolling-item";
            div.innerHTML = `
                <div class="image-container">
                    <img src="${item.image}" alt="${item.name}" />
                </div>
                <p>${item.name}</p>
                <div class="item-price">${item.price} ₽</div>
            `;
            return div;
        }

        // Добавляем все предметы в прокрутку (несколько раз для бесконечности)
        for (let i = 0; i < 3; i++) {
            items.forEach(item => {
                scrollingList.appendChild(createScrollingItem(item));
            });
        }

        // Запускаем анимацию прокрутки
        startScrollingAnimation();
    }

    // Функция для запуска анимации прокрутки
    function startScrollingAnimation() {
      const scrollingList = document.getElementById('scrollingList');
      const items = scrollingList.children;
      const itemWidth = items[0].offsetWidth + 40; // width + gap
      
      let position = 0;
      const speed = 1; // пикселей за кадр
      
      function animate() {
        position -= speed;
        
        // Если прокрутили половину контента, сбрасываем позицию
        if (Math.abs(position) >= (scrollingList.scrollWidth / 2)) {
          position = 0;
        }
        
        scrollingList.style.transform = `translateX(${position}px)`;
        requestAnimationFrame(animate);
      }
      
      animate();
    }

    // Функция для инициализации колеса фортуны
    function initWheel(wheelId) {
      const wheel = document.getElementById(wheelId);
      wheel.innerHTML = '';
      
      // Награды для колеса фортуны
      const rewards = [
        { name: "Меч Легенды", type: "item", value: 2500, color: "#ff6b6b" },
        { name: "100 ₽", type: "money", value: 100, color: "#4ecdc4" },
        { name: "Неудача", type: "fail", value: 0, color: "#45b7d1" },
        { name: "Щит Щитовой", type: "item", value: 1200, color: "#96ceb4" },
        { name: "50 ₽", type: "money", value: 50, color: "#feca57" },
        { name: "Неудача", type: "fail", value: 0, color: "#ff9ff3" },
        { name: "Амулет Огня", type: "item", value: 1500, color: "#54a0ff" },
        { name: "200 ₽", type: "money", value: 200, color: "#5f27cd" }
      ];
      
      const anglePerItem = 360 / rewards.length;
      
      // Создаем секции колеса
      rewards.forEach((reward, index) => {
        const item = document.createElement('div');
        item.className = 'wheel-item';
        item.style.transform = `rotate(${index * anglePerItem}deg)`;
        item.style.background = `conic-gradient(${reward.color} 0deg ${anglePerItem}deg, transparent ${anglePerItem}deg)`;
        item.innerHTML = `
          <div style="transform: rotate(${anglePerItem/2}deg); font-size: 0.9rem;">
            ${reward.name}
          </div>
        `;
        wheel.appendChild(item);
      });
      
      // Сбрасываем вращение колеса
      wheel.style.transform = 'rotate(0deg)';
    }

    // Функция для обновления таймера до следующего вращения
    function updateFortuneTimer(timerId) {
      const timerElement = document.getElementById(timerId);
      const now = Date.now();
      const timeSinceLastSpin = now - lastSpinTime;
      const timeUntilNextSpin = 24 * 60 * 60 * 1000 - timeSinceLastSpin; // 24 часа в миллисекундах
      
      if (timeUntilNextSpin <= 0) {
        timerElement.textContent = "Вы можете крутить колесо!";
        document.getElementById('spinButton').disabled = false;
        document.getElementById('mainSpinButton').disabled = false;
      } else {
        const hours = Math.floor(timeUntilNextSpin / (60 * 60 * 1000));
        const minutes = Math.floor((timeUntilNextSpin % (60 * 60 * 1000)) / (60 * 1000));
        const seconds = Math.floor((timeUntilNextSpin % (60 * 1000)) / 1000);
        
        timerElement.textContent = `Следующее вращение через: ${hours}ч ${minutes}м ${seconds}с`;
        document.getElementById('spinButton').disabled = true;
        document.getElementById('mainSpinButton').disabled = true;
        
        // Обновляем таймер каждую секунду
        setTimeout(() => updateFortuneTimer(timerId), 1000);
      }
    }

    // Функция для вращения колеса в модальном окне
    function spinWheel() {
      if (wheelSpinning) return;
      
      const now = Date.now();
      const timeSinceLastSpin = now - lastSpinTime;
      
      // Проверяем, прошло ли 24 часа с последнего вращения
      if (timeSinceLastSpin < 24 * 60 * 60 * 1000) {
        const timeUntilNextSpin = 24 * 60 * 60 * 1000 - timeSinceLastSpin;
        const hours = Math.floor(timeUntilNextSpin / (60 * 60 * 1000));
        const minutes = Math.floor((timeUntilNextSpin % (60 * 60 * 1000)) / (60 * 1000));
        alert(`Вы уже крутили колесо сегодня. Следующее вращение будет доступно через ${hours}ч ${minutes}м`);
        return;
      }
      
      wheelSpinning = true;
      const wheel = document.getElementById('fortuneWheel');
      const spinButton = document.getElementById('spinButton');
      const resultElement = document.getElementById('fortuneResult');
      
      spinButton.disabled = true;
      resultElement.style.display = 'none';
      
      // Случайное количество оборотов (от 5 до 10 полных оборотов)
      const spins = 5 + Math.floor(Math.random() * 6);
      const degrees = spins * 360;
      
      // Случайный угол остановки (от 0 до 360 градусов)
      const stopAngle = Math.floor(Math.random() * 360);
      
      // Общее вращение
      const totalRotation = degrees + stopAngle;
      
      // Анимация вращения
      wheel.style.transition = 'transform 5s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
      wheel.style.transform = `rotate(${totalRotation}deg)`;
      
      // Определяем выигрыш после завершения вращения
      setTimeout(() => {
        // Нормализуем угол остановки (0-360)
        const normalizedAngle = (360 - (totalRotation % 360)) % 360;
        
        // Определяем секцию, на которую указала стрелка
        const rewards = [
          { name: "Меч Легенды", type: "item", value: 2500 },
          { name: "100 ₽", type: "money", value: 100 },
          { name: "Неудача", type: "fail", value: 0 },
          { name: "Щит Щитовой", type: "item", value: 1200 },
          { name: "50 ₽", type: "money", value: 50 },
          { name: "Неудача", type: "fail", value: 0 },
          { name: "Амулет Огня", type: "item", value: 1500 },
          { name: "200 ₽", type: "money", value: 200 }
        ];
        
        const anglePerItem = 360 / rewards.length;
        const winningIndex = Math.floor(normalizedAngle / anglePerItem);
        const reward = rewards[winningIndex];
        
        // Показываем результат
        showFortuneResult(reward, resultElement);
        
        // Сохраняем время последнего вращения
        lastSpinTime = now;
        localStorage.setItem('lastFortuneSpin', lastSpinTime);
        
        wheelSpinning = false;
        updateFortuneTimer('fortuneTimer');
      }, 5000);
    }

    // Функция для вращения основного колеса на странице
    function spinMainWheel() {
      if (wheelSpinning) return;
      
      const now = Date.now();
      const timeSinceLastSpin = now - lastSpinTime;
      
      // Проверяем, прошло ли 24 часа с последнего вращения
      if (timeSinceLastSpin < 24 * 60 * 60 * 1000) {
        const timeUntilNextSpin = 24 * 60 * 60 * 1000 - timeSinceLastSpin;
        const hours = Math.floor(timeUntilNextSpin / (60 * 60 * 1000));
        const minutes = Math.floor((timeUntilNextSpin % (60 * 60 * 1000)) / (60 * 1000));
        alert(`Вы уже крутили колесо сегодня. Следующее вращение будет доступно через ${hours}ч ${minutes}м`);
        return;
      }
      
      wheelSpinning = true;
      const wheel = document.getElementById('mainFortuneWheel');
      const spinButton = document.getElementById('mainSpinButton');
      const resultElement = document.getElementById('mainFortuneResult');
      
      spinButton.disabled = true;
      resultElement.style.display = 'none';
      
      // Случайное количество оборотов (от 5 до 10 полных оборотов)
      const spins = 5 + Math.floor(Math.random() * 6);
      const degrees = spins * 360;
      
      // Случайный угол остановки (от 0 до 360 градусов)
      const stopAngle = Math.floor(Math.random() * 360);
      
      // Общее вращение
      const totalRotation = degrees + stopAngle;
      
      // Анимация вращения
      wheel.style.transition = 'transform 5s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
      wheel.style.transform = `rotate(${totalRotation}deg)`;
      
      // Определяем выигрыш после завершения вращения
      setTimeout(() => {
        // Нормализуем угол остановки (0-360)
        const normalizedAngle = (360 - (totalRotation % 360)) % 360;
        
        // Определяем секцию, на которую указала стрелка
        const rewards = [
          { name: "Меч Легенды", type: "item", value: 2500 },
          { name: "100 ₽", type: "money", value: 100 },
          { name: "Неудача", type: "fail", value: 0 },
          { name: "Щит Щитовой", type: "item", value: 1200 },
          { name: "50 ₽", type: "money", value: 50 },
          { name: "Неудача", type: "fail", value: 0 },
          { name: "Амулет Огня", type: "item", value: 1500 },
          { name: "200 ₽", type: "money", value: 200 }
        ];
        
        const anglePerItem = 360 / rewards.length;
        const winningIndex = Math.floor(normalizedAngle / anglePerItem);
        const reward = rewards[winningIndex];
        
        // Показываем результат
        showFortuneResult(reward, resultElement);
        
        // Сохраняем время последнего вращения
        lastSpinTime = now;
        localStorage.setItem('lastFortuneSpin', lastSpinTime);
        
        wheelSpinning = false;
        updateFortuneTimer('mainFortuneTimer');
      }, 5000);
    }

    // Функция для показа результата вращения колеса
    function showFortuneResult(reward, resultElement) {
      let resultHTML = '';
      
      if (reward.type === 'fail') {
        resultHTML = `
          <h3>Увы, неудача!</h3>
          <p>В этот раз вам не повезло. Попробуйте снова завтра!</p>
          <div style="font-size: 3rem; color: #ff6b6b; margin: 15px 0;">
            <i class="fas fa-times-circle"></i>
          </div>
        `;
      } else if (reward.type === 'money') {
        // Добавляем деньги на баланс
        if (currentUser) {
          const users = JSON.parse(localStorage.getItem('users') || '[]');
          const userIndex = users.findIndex(u => u.id === currentUser.id);
          
          if (userIndex !== -1) {
            users[userIndex].balance = (users[userIndex].balance || 0) + reward.value;
            localStorage.setItem('users', JSON.stringify(users));
            
            currentUser.balance = users[userIndex].balance;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            updateUI();
          }
        }
        
        resultHTML = `
          <h3>Поздравляем!</h3>
          <p>Вы выиграли <strong>${reward.value} ₽</strong>!</p>
          <div style="font-size: 3rem; color: #ffd700; margin: 15px 0;">
            <i class="fas fa-coins"></i>
          </div>
          <p>Деньги добавлены на ваш баланс.</p>
        `;
      } else if (reward.type === 'item') {
        // Добавляем предмет в выпавшие предметы
        if (currentUser) {
          const item = {
            id: Date.now(),
            name: reward.name,
            image: getItemImage(reward.name),
            price: reward.value,
            type: "weapon",
            quality: "epic",
            rarity: "mythical"
          };
          
          const users = JSON.parse(localStorage.getItem('users') || '[]');
          const userIndex = users.findIndex(u => u.id === currentUser.id);
          
          if (userIndex !== -1) {
            if (!users[userIndex].dropItems) {
              users[userIndex].dropItems = [];
            }
            users[userIndex].dropItems.push(item);
            localStorage.setItem('users', JSON.stringify(users));
            
            currentUser.dropItems = users[userIndex].dropItems;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
          }
        }
        
        resultHTML = `
          <h3>Поздравляем!</h3>
          <p>Вы выиграли <strong>${reward.name}</strong>!</p>
          <div style="display: flex; align-items: center; gap: 15px; margin: 15px 0;">
            <img src="${getItemImage(reward.name)}" alt="${reward.name}" style="width: 80px; height: 80px; border-radius: 8px; border: 2px solid var(--primary);" />
            <div>
              <div style="font-weight: 600; font-size: 1.2rem;">${reward.name}</div>
              <div style="color: #ffd700; font-weight: 600;">${reward.value} ₽</div>
            </div>
          </div>
          <p>Предмет добавлен в раздел "Выпавшие предметы" в вашем профиле!</p>
        `;
      }
      
      resultElement.innerHTML = resultHTML;
      resultElement.style.display = 'block';
    }

    // Вспомогательная функция для получения изображения предмета по имени
    function getItemImage(itemName) {
      const itemImages = {
        "Меч Легенды": "https://avatars.mds.yandex.net/i?id=a88b84155a670aee41eb90fb30cb6ec0a4c71d8d-12923554-images-thumbs&n=13",
        "Щит Щитовой": "https://avatars.mds.yandex.net/i?id=779e43be547a33f1413b71701d623dc7_l-4779391-images-thumbs&n=13",
        "Амулет Огня": "https://avatars.dzeninfra.ru/get-zen_doc/1687249/pub_5fdf65e53713a37b868f1f06_5fdf6bf8c80827600fc11220/scale_1200"
      };
      
      return itemImages[itemName] || "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/blade_of_alacrity.png";
    }

    // Инициализация при загрузке страницы
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Инициализация приложения...');
      
      // Гарантируем существование администратора
      ensureAdminExists();
      
      // Выводим отладочную информацию
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      console.log('Загружены пользователи:', users);
      
      // Применяем сохраненную тему
      if (isLightTheme) {
        document.body.classList.add('light-theme');
        document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
      }
      
      // Создаем киберпанк заставку
      createCyberGrid();
      showHackingText();
      hideLoader();
      
      // Создаем частицы
      createParticles();
      
      // Проверяем, есть ли сохраненный пользователь
      const savedUser = localStorage.getItem('currentUser');
      if (savedUser) {
          currentUser = JSON.parse(savedUser);
          console.log('Найден сохраненный пользователь:', currentUser);
      }
      
      updateUI();
      loadVKPostsOnMainPage();
      initInfiniteScroll();
      applyFilters();
      filterItems();
      
      // Инициализация колеса фортуны
      initWheel('mainFortuneWheel');
      updateFortuneTimer('mainFortuneTimer');
      
      // Инициализация ИИ-ассистента
      document.getElementById('aiAssistantToggle').addEventListener('click', toggleAIChat);
      
      // Инициализация чат-бота
      document.getElementById('chatBotToggle').addEventListener('click', toggleChatBot);
      
      // Инициализация загрузки изображений
      initImageUpload();
      
      // Инициализация формы создания поста
      document.getElementById('createPostForm').addEventListener('submit', createSitePost);
      
      // Счетчик символов для формы создания поста
      document.getElementById('postContent').addEventListener('input', function() {
        document.getElementById('postCharCount').textContent = this.value.length;
      });
      
      // Отправка сообщения по Enter в ИИ-ассистенте
      document.getElementById('aiChatInput').addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
              sendMessage();
          }
      });
      
      // Отправка сообщения по Enter в чат-боте
      document.getElementById('chatBotInput').addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
              sendBotMessage();
          }
      });
      
      // Обработчики форм
      document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        console.log('Попытка входа:', email);
        
        if (login(email, password)) {
          alert('Успешный вход! Добро пожаловать!');
        } else {
          alert('Неверный email или пароль! Попробуйте admin@ya.ru / admin123');
        }
      });

      document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const name = document.getElementById('registerName').value;
        const email = document.getElementById('registerEmail').value;
        const password = document.getElementById('registerPassword').value;
        const confirmPassword = document.getElementById('registerConfirmPassword').value;
        
        if (password !== confirmPassword) {
          alert('Пароли не совпадают!');
          return;
        }
        
        if (register(name, email, password)) {
          // Успешная регистрация обрабатывается в функции register
        } else {
          alert('Пользователь с таким email уже существует!');
        }
      });

      // Обработчик формы пополнения баланса
      document.getElementById('depositForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const amount = parseInt(document.getElementById('amount').value);
        
        if (addBalance(amount)) {
          alert(`Баланс успешно пополнен на ${amount} ₽!`);
          closeModal('balanceModal');
        } else {
          alert('Ошибка пополнения баланса!');
        }
      });
      
      // Обработчик формы вывода средств
      document.getElementById('withdrawForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const amount = parseInt(document.getElementById('withdrawAmount').value);
        const selectedBank = document.querySelector('.bank-option.selected');
        
        if (!selectedBank) {
          alert('Пожалуйста, выберите банк для вывода средств!');
          return;
        }
        
        const bank = selectedBank.dataset.bank;
        const bankNames = {
          'sber': 'Сбербанк',
          'tinkoff': 'Тинькофф',
          'vtb': 'ВТБ',
          'alfa': 'Альфа-Банк'
        };
        
        if (withdrawBalance(amount, bankNames[bank])) {
          alert(`Заявка на вывод ${amount} ₽ в ${bankNames[bank]} успешно отправлена!`);
          closeModal('balanceModal');
        } else {
          alert('Ошибка вывода средств!');
        }
      });
      
      // Обработчики выбора банка
      document.querySelectorAll('.bank-option').forEach(option => {
        option.addEventListener('click', function() {
          document.querySelectorAll('.bank-option').forEach(opt => {
            opt.classList.remove('selected');
          });
          this.classList.add('selected');
        });
      });
      
      // Инициализация предметов
      const items = [
          {
              id: 1,
              name: "Меч Легенды",
              image: "https://avatars.mds.yandex.net/i?id=a88b84155a670aee41eb90fb30cb6ec0a4c71d8d-12923554-images-thumbs&n=13",
              price: 2500,
              type: "weapon",
              quality: "legendary",
              rarity: "immortal"
          },
          {
              id: 2,
              name: "Щит Щитовой",
              image: "https://avatars.mds.yandex.net/i?id=779e43be547a33f1413b71701d623dc7_l-4779391-images-thumbs&n=13",
              price: 1200,
              type: "armor",
              quality: "epic",
              rarity: "mythical"
          },
          {
              id: 3,
              name: "Зелье Лечения",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/tango.png",
              price: 50,
              type: "potion",
              quality: "common",
              rarity: "common"
          },
          {
              id: 4,
              name: "Кольцо Могущества",
              image: "https://avatars.yandex.net/get-music-content/2427101/93572bab.a.8094099-3/m1000x1000",
              price: 800,
              type: "accessory",
              quality: "rare",
              rarity: "rare"
          },
          {
              id: 5,
              name: "Амулет Огня",
              image: "https://avatars.dzeninfra.ru/get-zen_doc/1687249/pub_5fdf65e53713a37b868f1f06_5fdf6bf8c80827600fc11220/scale_1200",
              price: 1500,
              type: "accessory",
              quality: "epic",
              rarity: "mythical"
          },
          {
              id: 6,
              name: "Сапоги Скорости",
              image: "https://images.steamusercontent.com/ugc/2015953485211818058/F346B37985E99B8154887E7E71D5F1E1C550D483/?imw=5000&imh=5000&ima=fit&impolicy=Letterbox&imcolor=%23000000&letterbox=false",
              price: 600,
              type: "armor",
              quality: "uncommon",
              rarity: "uncommon"
          },
          {
              id: 7,
              name: "Клинок Раздора",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/blade_of_alacrity.png",
              price: 450,
              type: "weapon",
              quality: "rare",
              rarity: "rare"
          },
          {
              id: 8,
              name: "Посох Чародея",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/staff_of_wizardry.png",
              price: 700,
              type: "weapon",
              quality: "epic",
              rarity: "mythical"
          },
          {
              id: 9,
              name: "Кольцо Регенерации",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/ring_of_regen.png",
              price: 300,
              type: "accessory",
              quality: "uncommon",
              rarity: "uncommon"
          },
          {
              id: 10,
              name: "Перчатки Ловкости",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/gloves_of_haste.png",
              price: 400,
              type: "armor",
              quality: "common",
              rarity: "common"
          },
          {
              id: 11,
              name: "Мантия Разума",
              image: "https://cdnb.artstation.com/p/assets/images/images/079/588/287/large/wassup-homie-glimmer-cape.jpg?1725312219",
              price: 350,
              type: "armor",
              quality: "common",
              rarity: "common"
          },
          {
              id: 12,
              name: "Цепь Железной Воли",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/chainmail.png",
              price: 550,
              type: "armor",
              quality: "uncommon",
              rarity: "uncommon"
          },
          {
              id: 13,
              name: "Курительная Трубка",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/smoke_of_deceit.png",
              price: 100,
              type: "accessory",
              quality: "common",
              rarity: "common"
          },
          {
              id: 14,
              name: "Пыльное Кольцо",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/ring_of_basilius.png",
              price: 250,
              type: "accessory",
              quality: "uncommon",
              rarity: "uncommon"
          },
          {
              id: 15,
              name: "Слеза Богини",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/aether_lens.png",
              price: 1200,
              type: "accessory",
              quality: "epic",
              rarity: "mythical"
          },
          {
              id: 16,
              name: "Сфера Этериала",
              image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/ethereal_blade.png",
              price: 2800,
              type: "weapon",
              quality: "legendary",
              rarity: "immortal"
          }
      ];

      const myItemsList = document.getElementById("myItemsList");
      const exchangeItemsList = document.getElementById("exchangeItemsList");
      const exchangeButton = document.getElementById("exchangeButton");

      // Функция для создания элемента предмета
      function createItemElement(item, type) {
          const container = document.createElement("div");
          container.className = "item-select";
          container.dataset.id = item.id;
          container.tabIndex = 0;
          container.innerHTML = `
              <div class="item-image-container">
                  <img src="${item.image}" alt="${item.name}" />
                  <button class="item-info-btn" onclick="event.stopPropagation(); showItemInfo(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                      <i class="fas fa-info"></i>
                  </button>
              </div>
              <h3>${item.name}</h3>
              <div class="item-price">${item.price} ₽</div>
          `;
          container.addEventListener("click", () => {
              selectItem(item, type);
          });
          container.addEventListener("keydown", (e) => {
              if (e.key === "Enter" || e.key === " ") {
                  e.preventDefault();
                  selectItem(item, type);
              }
          });
          return container;
      }

      // Добавляем предметы в списки
      items.forEach((item) => {
          myItemsList.appendChild(createItemElement(item, 'offer'));
          exchangeItemsList.appendChild(createItemElement(item, 'want'));
      });

      // Обработчик кнопки обмена
      exchangeButton.addEventListener("click", () => {
          if (!currentUser) {
              alert("Для обмена предметами необходимо войти в систему!");
              showLogin();
              return;
          }

          if (selectedOfferItems.length === 0 || selectedWantItems.length === 0) {
              alert("Пожалуйста, выберите предметы для обмена с обеих сторон!");
              return;
          }
          
          const offerTotal = selectedOfferItems.reduce((sum, item) => sum + item.price, 0);
          const wantTotal = selectedWantItems.reduce((sum, item) => sum + item.price, 0);
          const priceDifference = wantTotal - offerTotal;
          
          // Проверка баланса для доплаты
          if (priceDifference > 0 && currentUser.balance < priceDifference) {
              alert(`Для этого обмена необходимо доплатить ${priceDifference} ₽!\nВаш баланс: ${currentUser.balance} ₽`);
              showBalanceModal();
              return;
          }
          
          let exchangeText = `🎮 ЗАПРОС НА ОБМЕН 🎮\n\n` +
                            `📤 ВЫ ОТДАЕТЕ (${selectedOfferItems.length} предметов):\n` +
                            selectedOfferItems.map(item => `• ${item.name} - ${item.price} ₽`).join('\n') +
                            `\n\nИтого: ${offerTotal} ₽\n\n` +
                            `📥 ВЫ ПОЛУЧАЕТЕ (${selectedWantItems.length} предметов):\n` +
                            selectedWantItems.map(item => `• ${item.name} - ${item.price} ₽`).join('\n') +
                            `\n\nИтого: ${wantTotal} ₽`;
          
          if (priceDifference > 0) {
              exchangeText += `\n\n💰 ДОПЛАТА: ${priceDifference} ₽`;
          } else if (priceDifference < 0) {
              exchangeText += `\n\n💰 ВАМ ВОЗВРАТ: ${Math.abs(priceDifference)} ₽`;
          }
          
          exchangeText += `\n\nПодтвердить обмен?`;
          
          // Показываем красивое окно подтверждения
          setTimeout(() => {
              const exchangeConfirmed = confirm(exchangeText);
              
              if (exchangeConfirmed) {
                  // Обработка доплаты/возврата
                  if (priceDifference !== 0) {
                      const users = JSON.parse(localStorage.getItem('users') || '[]');
                      const userIndex = users.findIndex(u => u.id === currentUser.id);
                      
                      if (userIndex !== -1) {
                          users[userIndex].balance -= priceDifference;
                          localStorage.setItem('users', JSON.stringify(users));
                          currentUser.balance = users[userIndex].balance;
                          localStorage.setItem('currentUser', JSON.stringify(currentUser));
                          updateUI();
                      }
                  }
                  
                  // Добавляем запись в историю обменов
                  exchangeHistory.push({
                    userId: currentUser.id,
                    userName: currentUser.name,
                    offerItems: [...selectedOfferItems],
                    wantItems: [...selectedWantItems],
                    offerTotal: offerTotal,
                    wantTotal: wantTotal,
                    difference: priceDifference,
                    date: new Date().toISOString(),
                    status: 'completed'
                  });
                  localStorage.setItem('exchangeHistory', JSON.stringify(exchangeHistory));
                  
                  alert(`✅ ОБМЕН УСПЕШНО ВЫПОЛНЕН!\n\n` +
                        `Обменяно ${selectedOfferItems.length} предметов на ${selectedWantItems.length} предметов` +
                        (priceDifference !== 0 ? `\n\n${priceDifference > 0 ? 'Списано' : 'Начислено'} ${Math.abs(priceDifference)} ₽` : '') +
                        `\n\nС вами свяжется администратор для завершения сделки.`);
                  
                  // Очищаем выбранные предметы после успешного обмена
                  selectedOfferItems = [];
                  selectedWantItems = [];
                  updateSelectedItemsDisplay();
              }
          }, 500);
      });
    });
  </script>
</body>
</html>
